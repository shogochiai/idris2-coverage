<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html;charset=utf-8">
<title>/Users/bob/code/idris2-coverage/test-data/build/exec/sample_app/sample.ss</title>
<style type="text/css">
* { border: 0; margin: 0; outline: 0; padding: 0; vertical-align: baseline; }
code, kbd, pre, samp { font-family: monospace, monospace; font-size: 1rem; }
html { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; }
table { border-collapse: collapse; border-spacing: 0; }
body { padding: 1rem; }
h1, h2, h3, h4 { line-height: 1.25; margin-bottom: 0.5rem; }
h1 { font-size: 1.296rem; }
h2 { font-size: 1.215rem; }
h3 { font-size: 1.138rem; }
h4 { font-size: 1.067rem; }
html { font-family: monospace, monospace; font-size: 1rem; }
p { margin-bottom: 1.25rem; }
.pc0 { background-color: #111111; color: white; white-space: nowrap; }
.pc1 { background-color: #607D8B; color: white; white-space: nowrap; }
.pc2 { background-color: #9C27B0; color: black; white-space: nowrap; }
.pc3 { background-color: #673AB7; color: white; white-space: nowrap; }
.pc4 { background-color: #3F51B5; color: white; white-space: nowrap; }
.pc5 { background-color: #2196F3; color: black; white-space: nowrap; }
.pc6 { background-color: #00BCD4; color: black; white-space: nowrap; }
.pc7 { background-color: #4CAF50; color: black; white-space: nowrap; }
.pc8 { background-color: #CDDC39; color: black; white-space: nowrap; }
.pc9 { background-color: #FFEB3B; color: black; white-space: nowrap; }
.pc10 { background-color: #FFC107; color: black; white-space: nowrap; }
.pc11 { background-color: #FF9800; color: black; white-space: nowrap; }
.pc12 { background-color: #F44336; color: white; white-space: nowrap; }
</style>
</head>
<body class=pc0>
<h1 style="margin-bottom: 1rem">/Users/bob/code/idris2-coverage/test-data/build/exec/sample_app/sample.ss<span style="opacity: 0.5"> on Fri Dec  5 07:21:06 2025</span></h1>
<table><tr><td style="color: #666666; font-weight: bold; padding-right: 1rem; text-align: right"><pre>
<span id=line1>1
</span><span id=line2>2
</span><span id=line3>3
</span><span id=line4>4
</span><span id=line5>5
</span><span id=line6>6
</span><span id=line7>7
</span><span id=line8>8
</span><span id=line9>9
</span><span id=line10>10
</span><span id=line11>11
</span><span id=line12>12
</span><span id=line13>13
</span><span id=line14>14
</span><span id=line15>15
</span><span id=line16>16
</span><span id=line17>17
</span><span id=line18>18
</span><span id=line19>19
</span><span id=line20>20
</span><span id=line21>21
</span><span id=line22>22
</span><span id=line23>23
</span><span id=line24>24
</span><span id=line25>25
</span><span id=line26>26
</span><span id=line27>27
</span><span id=line28>28
</span><span id=line29>29
</span><span id=line30>30
</span><span id=line31>31
</span><span id=line32>32
</span><span id=line33>33
</span><span id=line34>34
</span><span id=line35>35
</span><span id=line36>36
</span><span id=line37>37
</span><span id=line38>38
</span><span id=line39>39
</span><span id=line40>40
</span><span id=line41>41
</span><span id=line42>42
</span><span id=line43>43
</span><span id=line44>44
</span><span id=line45>45
</span><span id=line46>46
</span><span id=line47>47
</span><span id=line48>48
</span><span id=line49>49
</span><span id=line50>50
</span><span id=line51>51
</span><span id=line52>52
</span><span id=line53>53
</span><span id=line54>54
</span><span id=line55>55
</span><span id=line56>56
</span><span id=line57>57
</span><span id=line58>58
</span><span id=line59>59
</span><span id=line60>60
</span><span id=line61>61
</span><span id=line62>62
</span><span id=line63>63
</span><span id=line64>64
</span><span id=line65>65
</span><span id=line66>66
</span><span id=line67>67
</span><span id=line68>68
</span><span id=line69>69
</span><span id=line70>70
</span><span id=line71>71
</span><span id=line72>72
</span><span id=line73>73
</span><span id=line74>74
</span><span id=line75>75
</span><span id=line76>76
</span><span id=line77>77
</span><span id=line78>78
</span><span id=line79>79
</span><span id=line80>80
</span><span id=line81>81
</span><span id=line82>82
</span><span id=line83>83
</span><span id=line84>84
</span><span id=line85>85
</span><span id=line86>86
</span><span id=line87>87
</span><span id=line88>88
</span><span id=line89>89
</span><span id=line90>90
</span><span id=line91>91
</span><span id=line92>92
</span><span id=line93>93
</span><span id=line94>94
</span><span id=line95>95
</span><span id=line96>96
</span><span id=line97>97
</span><span id=line98>98
</span><span id=line99>99
</span><span id=line100>100
</span><span id=line101>101
</span><span id=line102>102
</span><span id=line103>103
</span><span id=line104>104
</span><span id=line105>105
</span><span id=line106>106
</span><span id=line107>107
</span><span id=line108>108
</span><span id=line109>109
</span><span id=line110>110
</span><span id=line111>111
</span><span id=line112>112
</span><span id=line113>113
</span><span id=line114>114
</span><span id=line115>115
</span><span id=line116>116
</span><span id=line117>117
</span><span id=line118>118
</span><span id=line119>119
</span><span id=line120>120
</span><span id=line121>121
</span><span id=line122>122
</span><span id=line123>123
</span><span id=line124>124
</span><span id=line125>125
</span><span id=line126>126
</span><span id=line127>127
</span><span id=line128>128
</span><span id=line129>129
</span><span id=line130>130
</span><span id=line131>131
</span><span id=line132>132
</span><span id=line133>133
</span><span id=line134>134
</span><span id=line135>135
</span><span id=line136>136
</span><span id=line137>137
</span><span id=line138>138
</span><span id=line139>139
</span><span id=line140>140
</span><span id=line141>141
</span><span id=line142>142
</span><span id=line143>143
</span><span id=line144>144
</span><span id=line145>145
</span><span id=line146>146
</span><span id=line147>147
</span><span id=line148>148
</span><span id=line149>149
</span><span id=line150>150
</span><span id=line151>151
</span><span id=line152>152
</span><span id=line153>153
</span><span id=line154>154
</span><span id=line155>155
</span><span id=line156>156
</span><span id=line157>157
</span><span id=line158>158
</span><span id=line159>159
</span><span id=line160>160
</span><span id=line161>161
</span><span id=line162>162
</span><span id=line163>163
</span><span id=line164>164
</span><span id=line165>165
</span><span id=line166>166
</span><span id=line167>167
</span><span id=line168>168
</span><span id=line169>169
</span><span id=line170>170
</span><span id=line171>171
</span><span id=line172>172
</span><span id=line173>173
</span><span id=line174>174
</span><span id=line175>175
</span><span id=line176>176
</span><span id=line177>177
</span><span id=line178>178
</span><span id=line179>179
</span><span id=line180>180
</span><span id=line181>181
</span><span id=line182>182
</span><span id=line183>183
</span><span id=line184>184
</span><span id=line185>185
</span><span id=line186>186
</span><span id=line187>187
</span><span id=line188>188
</span><span id=line189>189
</span><span id=line190>190
</span><span id=line191>191
</span><span id=line192>192
</span><span id=line193>193
</span><span id=line194>194
</span><span id=line195>195
</span><span id=line196>196
</span><span id=line197>197
</span><span id=line198>198
</span><span id=line199>199
</span><span id=line200>200
</span><span id=line201>201
</span><span id=line202>202
</span><span id=line203>203
</span><span id=line204>204
</span><span id=line205>205
</span><span id=line206>206
</span><span id=line207>207
</span><span id=line208>208
</span><span id=line209>209
</span><span id=line210>210
</span><span id=line211>211
</span><span id=line212>212
</span><span id=line213>213
</span><span id=line214>214
</span><span id=line215>215
</span><span id=line216>216
</span><span id=line217>217
</span><span id=line218>218
</span><span id=line219>219
</span><span id=line220>220
</span><span id=line221>221
</span><span id=line222>222
</span><span id=line223>223
</span><span id=line224>224
</span><span id=line225>225
</span><span id=line226>226
</span><span id=line227>227
</span><span id=line228>228
</span><span id=line229>229
</span><span id=line230>230
</span><span id=line231>231
</span><span id=line232>232
</span><span id=line233>233
</span><span id=line234>234
</span><span id=line235>235
</span><span id=line236>236
</span><span id=line237>237
</span><span id=line238>238
</span><span id=line239>239
</span><span id=line240>240
</span><span id=line241>241
</span><span id=line242>242
</span><span id=line243>243
</span><span id=line244>244
</span><span id=line245>245
</span><span id=line246>246
</span><span id=line247>247
</span><span id=line248>248
</span><span id=line249>249
</span><span id=line250>250
</span><span id=line251>251
</span><span id=line252>252
</span><span id=line253>253
</span><span id=line254>254
</span><span id=line255>255
</span><span id=line256>256
</span><span id=line257>257
</span><span id=line258>258
</span><span id=line259>259
</span><span id=line260>260
</span><span id=line261>261
</span><span id=line262>262
</span><span id=line263>263
</span><span id=line264>264
</span><span id=line265>265
</span><span id=line266>266
</span><span id=line267>267
</span><span id=line268>268
</span><span id=line269>269
</span><span id=line270>270
</span><span id=line271>271
</span><span id=line272>272
</span><span id=line273>273
</span><span id=line274>274
</span><span id=line275>275
</span><span id=line276>276
</span><span id=line277>277
</span><span id=line278>278
</span><span id=line279>279
</span><span id=line280>280
</span><span id=line281>281
</span><span id=line282>282
</span><span id=line283>283
</span><span id=line284>284
</span><span id=line285>285
</span><span id=line286>286
</span><span id=line287>287
</span><span id=line288>288
</span><span id=line289>289
</span><span id=line290>290
</span><span id=line291>291
</span><span id=line292>292
</span><span id=line293>293
</span><span id=line294>294
</span><span id=line295>295
</span><span id=line296>296
</span><span id=line297>297
</span><span id=line298>298
</span><span id=line299>299
</span><span id=line300>300
</span><span id=line301>301
</span><span id=line302>302
</span><span id=line303>303
</span><span id=line304>304
</span><span id=line305>305
</span><span id=line306>306
</span><span id=line307>307
</span><span id=line308>308
</span><span id=line309>309
</span><span id=line310>310
</span><span id=line311>311
</span><span id=line312>312
</span><span id=line313>313
</span><span id=line314>314
</span><span id=line315>315
</span><span id=line316>316
</span><span id=line317>317
</span><span id=line318>318
</span><span id=line319>319
</span><span id=line320>320
</span><span id=line321>321
</span><span id=line322>322
</span><span id=line323>323
</span><span id=line324>324
</span><span id=line325>325
</span><span id=line326>326
</span><span id=line327>327
</span><span id=line328>328
</span><span id=line329>329
</span><span id=line330>330
</span><span id=line331>331
</span><span id=line332>332
</span><span id=line333>333
</span><span id=line334>334
</span><span id=line335>335
</span><span id=line336>336
</span><span id=line337>337
</span><span id=line338>338
</span><span id=line339>339
</span><span id=line340>340
</span><span id=line341>341
</span><span id=line342>342
</span><span id=line343>343
</span><span id=line344>344
</span><span id=line345>345
</span><span id=line346>346
</span><span id=line347>347
</span><span id=line348>348
</span><span id=line349>349
</span><span id=line350>350
</span><span id=line351>351
</span><span id=line352>352
</span><span id=line353>353
</span><span id=line354>354
</span><span id=line355>355
</span><span id=line356>356
</span><span id=line357>357
</span><span id=line358>358
</span><span id=line359>359
</span><span id=line360>360
</span><span id=line361>361
</span><span id=line362>362
</span><span id=line363>363
</span><span id=line364>364
</span><span id=line365>365
</span><span id=line366>366
</span><span id=line367>367
</span><span id=line368>368
</span><span id=line369>369
</span><span id=line370>370
</span><span id=line371>371
</span><span id=line372>372
</span><span id=line373>373
</span><span id=line374>374
</span><span id=line375>375
</span><span id=line376>376
</span><span id=line377>377
</span><span id=line378>378
</span><span id=line379>379
</span><span id=line380>380
</span><span id=line381>381
</span><span id=line382>382
</span><span id=line383>383
</span><span id=line384>384
</span><span id=line385>385
</span><span id=line386>386
</span><span id=line387>387
</span><span id=line388>388
</span><span id=line389>389
</span><span id=line390>390
</span><span id=line391>391
</span><span id=line392>392
</span><span id=line393>393
</span><span id=line394>394
</span><span id=line395>395
</span><span id=line396>396
</span><span id=line397>397
</span><span id=line398>398
</span><span id=line399>399
</span><span id=line400>400
</span><span id=line401>401
</span><span id=line402>402
</span><span id=line403>403
</span><span id=line404>404
</span><span id=line405>405
</span><span id=line406>406
</span><span id=line407>407
</span><span id=line408>408
</span><span id=line409>409
</span><span id=line410>410
</span><span id=line411>411
</span><span id=line412>412
</span><span id=line413>413
</span><span id=line414>414
</span><span id=line415>415
</span><span id=line416>416
</span><span id=line417>417
</span><span id=line418>418
</span><span id=line419>419
</span><span id=line420>420
</span><span id=line421>421
</span><span id=line422>422
</span><span id=line423>423
</span><span id=line424>424
</span><span id=line425>425
</span><span id=line426>426
</span><span id=line427>427
</span><span id=line428>428
</span><span id=line429>429
</span><span id=line430>430
</span><span id=line431>431
</span><span id=line432>432
</span><span id=line433>433
</span><span id=line434>434
</span><span id=line435>435
</span><span id=line436>436
</span><span id=line437>437
</span><span id=line438>438
</span><span id=line439>439
</span><span id=line440>440
</span><span id=line441>441
</span><span id=line442>442
</span><span id=line443>443
</span><span id=line444>444
</span><span id=line445>445
</span><span id=line446>446
</span><span id=line447>447
</span><span id=line448>448
</span><span id=line449>449
</span><span id=line450>450
</span><span id=line451>451
</span><span id=line452>452
</span><span id=line453>453
</span><span id=line454>454
</span><span id=line455>455
</span><span id=line456>456
</span><span id=line457>457
</span><span id=line458>458
</span><span id=line459>459
</span><span id=line460>460
</span><span id=line461>461
</span><span id=line462>462
</span><span id=line463>463
</span><span id=line464>464
</span><span id=line465>465
</span><span id=line466>466
</span><span id=line467>467
</span><span id=line468>468
</span><span id=line469>469
</span><span id=line470>470
</span><span id=line471>471
</span><span id=line472>472
</span><span id=line473>473
</span><span id=line474>474
</span><span id=line475>475
</span><span id=line476>476
</span><span id=line477>477
</span><span id=line478>478
</span><span id=line479>479
</span><span id=line480>480
</span><span id=line481>481
</span><span id=line482>482
</span><span id=line483>483
</span><span id=line484>484
</span><span id=line485>485
</span><span id=line486>486
</span><span id=line487>487
</span><span id=line488>488
</span><span id=line489>489
</span><span id=line490>490
</span><span id=line491>491
</span><span id=line492>492
</span><span id=line493>493
</span><span id=line494>494
</span><span id=line495>495
</span><span id=line496>496
</span><span id=line497>497
</span><span id=line498>498
</span><span id=line499>499
</span><span id=line500>500
</span><span id=line501>501
</span><span id=line502>502
</span><span id=line503>503
</span><span id=line504>504
</span><span id=line505>505
</span><span id=line506>506
</span><span id=line507>507
</span><span id=line508>508
</span><span id=line509>509
</span><span id=line510>510
</span><span id=line511>511
</span><span id=line512>512
</span><span id=line513>513
</span><span id=line514>514
</span><span id=line515>515
</span><span id=line516>516
</span><span id=line517>517
</span><span id=line518>518
</span><span id=line519>519
</span><span id=line520>520
</span><span id=line521>521
</span><span id=line522>522
</span><span id=line523>523
</span><span id=line524>524
</span><span id=line525>525
</span><span id=line526>526
</span><span id=line527>527
</span><span id=line528>528
</span><span id=line529>529
</span><span id=line530>530
</span><span id=line531>531
</span><span id=line532>532
</span><span id=line533>533
</span><span id=line534>534
</span><span id=line535>535
</span><span id=line536>536
</span><span id=line537>537
</span><span id=line538>538
</span><span id=line539>539
</span><span id=line540>540
</span><span id=line541>541
</span><span id=line542>542
</span><span id=line543>543
</span><span id=line544>544
</span><span id=line545>545
</span><span id=line546>546
</span><span id=line547>547
</span><span id=line548>548
</span><span id=line549>549
</span><span id=line550>550
</span><span id=line551>551
</span><span id=line552>552
</span><span id=line553>553
</span><span id=line554>554
</span><span id=line555>555
</span><span id=line556>556
</span><span id=line557>557
</span><span id=line558>558
</span><span id=line559>559
</span><span id=line560>560
</span><span id=line561>561
</span><span id=line562>562
</span><span id=line563>563
</span><span id=line564>564
</span><span id=line565>565
</span><span id=line566>566
</span><span id=line567>567
</span><span id=line568>568
</span><span id=line569>569
</span><span id=line570>570
</span><span id=line571>571
</span><span id=line572>572
</span><span id=line573>573
</span><span id=line574>574
</span><span id=line575>575
</span><span id=line576>576
</span><span id=line577>577
</span><span id=line578>578
</span><span id=line579>579
</span><span id=line580>580
</span><span id=line581>581
</span><span id=line582>582
</span><span id=line583>583
</span><span id=line584>584
</span><span id=line585>585
</span><span id=line586>586
</span><span id=line587>587
</span><span id=line588>588
</span><span id=line589>589
</span><span id=line590>590
</span><span id=line591>591
</span><span id=line592>592
</span><span id=line593>593
</span><span id=line594>594
</span><span id=line595>595
</span><span id=line596>596
</span><span id=line597>597
</span><span id=line598>598
</span><span id=line599>599
</span><span id=line600>600
</span><span id=line601>601
</span><span id=line602>602
</span><span id=line603>603
</span><span id=line604>604
</span><span id=line605>605
</span><span id=line606>606
</span><span id=line607>607
</span><span id=line608>608
</span><span id=line609>609
</span><span id=line610>610
</span><span id=line611>611
</span><span id=line612>612
</span><span id=line613>613
</span><span id=line614>614
</span><span id=line615>615
</span><span id=line616>616
</span><span id=line617>617
</span><span id=line618>618
</span><span id=line619>619
</span><span id=line620>620
</span><span id=line621>621
</span><span id=line622>622
</span><span id=line623>623
</span><span id=line624>624
</span><span id=line625>625
</span><span id=line626>626
</span><span id=line627>627
</span><span id=line628>628
</span><span id=line629>629
</span><span id=line630>630
</span><span id=line631>631
</span><span id=line632>632
</span><span id=line633>633
</span><span id=line634>634
</span><span id=line635>635
</span><span id=line636>636
</span><span id=line637>637
</span><span id=line638>638
</span><span id=line639>639
</span><span id=line640>640
</span><span id=line641>641
</span><span id=line642>642
</span><span id=line643>643
</span><span id=line644>644
</span><span id=line645>645
</span><span id=line646>646
</span><span id=line647>647
</span><span id=line648>648
</span><span id=line649>649
</span><span id=line650>650
</span><span id=line651>651
</span><span id=line652>652
</span><span id=line653>653
</span><span id=line654>654
</span><span id=line655>655
</span><span id=line656>656
</span><span id=line657>657
</span><span id=line658>658
</span><span id=line659>659
</span><span id=line660>660
</span><span id=line661>661
</span><span id=line662>662
</span><span id=line663>663
</span><span id=line664>664
</span><span id=line665>665
</span><span id=line666>666
</span><span id=line667>667
</span><span id=line668>668
</span><span id=line669>669
</span><span id=line670>670
</span><span id=line671>671
</span><span id=line672>672
</span><span id=line673>673
</span><span id=line674>674
</span><span id=line675>675
</span><span id=line676>676
</span><span id=line677>677
</span><span id=line678>678
</span><span id=line679>679
</span><span id=line680>680
</span><span id=line681>681
</span><span id=line682>682
</span><span id=line683>683
</span><span id=line684>684
</span><span id=line685>685
</span><span id=line686>686
</span><span id=line687>687
</span><span id=line688>688
</span><span id=line689>689
</span><span id=line690>690
</span><span id=line691>691
</span><span id=line692>692
</span><span id=line693>693
</span><span id=line694>694
</span><span id=line695>695
</span><span id=line696>696
</span><span id=line697>697
</span><span id=line698>698
</span><span id=line699>699
</span><span id=line700>700
</span><span id=line701>701
</span><span id=line702>702
</span><span id=line703>703
</span><span id=line704>704
</span><span id=line705>705
</span><span id=line706>706
</span><span id=line707>707
</span><span id=line708>708
</span><span id=line709>709
</span><span id=line710>710
</span><span id=line711>711
</span><span id=line712>712
</span><span id=line713>713
</span><span id=line714>714
</span><span id=line715>715
</span><span id=line716>716
</span><span id=line717>717
</span><span id=line718>718
</span><span id=line719>719
</span><span id=line720>720
</span><span id=line721>721
</span><span id=line722>722
</span><span id=line723>723
</span><span id=line724>724
</span><span id=line725>725
</span><span id=line726>726
</span><span id=line727>727
</span><span id=line728>728
</span><span id=line729>729
</span><span id=line730>730
</span><span id=line731>731
</span><span id=line732>732
</span><span id=line733>733
</span><span id=line734>734
</span><span id=line735>735
</span><span id=line736>736
</span><span id=line737>737
</span><span id=line738>738
</span><span id=line739>739
</span><span id=line740>740
</span><span id=line741>741
</span><span id=line742>742
</span><span id=line743>743
</span><span id=line744>744
</span><span id=line745>745
</span><span id=line746>746
</span><span id=line747>747
</span><span id=line748>748
</span><span id=line749>749
</span><span id=line750>750
</span><span id=line751>751
</span><span id=line752>752
</span><span id=line753>753
</span><span id=line754>754
</span><span id=line755>755
</span></pre></td><td><pre>
#!/opt/homebrew/bin/chez --program

;; @generated by Idris 0.8.0, Chez backend
(import (chezscheme))
<span class=pc8 title="line 5 char 1 count 1">(case </span><span class=pc8 title="line 5 char 7 count 1">(</span><span class=pc8 title="line 5 char 8 count 1">machine-type</span><span class=pc8 title="line 5 char 7 count 1">)</span>
  <span class=pc8 title="line 5 char 1 count 1">[(i3fb ti3fb a6fb ta6fb) #f]</span>
  <span class=pc8 title="line 5 char 1 count 1">[(i3le ti3le a6le ta6le tarm64le)</span>
     <span class=pc8 title="line 5 char 1 count 1">(with-exception-handler (lambda(x) (load-shared-object "libc.so"))</span>
        <span class=pc8 title="line 5 char 1 count 1">(lambda () (load-shared-object "libc.so.6")))]</span>
  <span class=pc8 title="line 5 char 1 count 1">[(i3osx ti3osx a6osx ta6osx tarm64osx tppc32osx tppc64osx) </span><span class=pc8 title="line 10 char 62 count 1">(</span><span class=pc8 title="line 10 char 63 count 1">load-shared-object</span><span class=pc8 title="line 10 char 62 count 1"> </span><span class=pc8 title="line 10 char 82 count 1">"libc.dylib"</span><span class=pc8 title="line 10 char 62 count 1">)</span><span class=pc8 title="line 5 char 1 count 1">]</span>
  <span class=pc8 title="line 5 char 1 count 1">[(i3nt ti3nt a6nt ta6nt) (load-shared-object "msvcrt.dll")]</span>
  <span class=pc8 title="line 5 char 1 count 1">[else (load-shared-object "libc.so")])</span>

<span class=pc8 title="line 14 char 1 count 1">(</span><span class=pc8 title="line 14 char 2 count 1">load-shared-object</span><span class=pc8 title="line 14 char 1 count 1"> </span><span class=pc8 title="line 14 char 21 count 1">"libidris2_support.dylib"</span><span class=pc8 title="line 14 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(let ()</span>
<span class=pc8 title="line 16 char 1 count 1">#!chezscheme</span>

<span class=pc8 title="line 19 char 1 count 1">(define (blodwen-os)</span>
  <span class=pc8 title="line 19 char 1 count 1">(case (machine-type)</span>
    <span class=pc8 title="line 19 char 1 count 1">[(i3le ti3le a6le ta6le tarm64le) "unix"]  ; GNU/Linux</span>
    <span class=pc8 title="line 19 char 1 count 1">[(i3ob ti3ob a6ob ta6ob tarm64ob) "unix"]  ; OpenBSD</span>
    <span class=pc8 title="line 19 char 1 count 1">[(i3fb ti3fb a6fb ta6fb tarm64fb) "unix"]  ; FreeBSD</span>
    <span class=pc8 title="line 19 char 1 count 1">[(i3nb ti3nb a6nb ta6nb tarm64nb) "unix"]  ; NetBSD</span>
    <span class=pc8 title="line 19 char 1 count 1">[(i3osx ti3osx a6osx ta6osx tarm64osx tppc32osx tppc64osx) "darwin"]</span>
    <span class=pc8 title="line 19 char 1 count 1">[(i3nt ti3nt a6nt ta6nt tarm64nt) "windows"]</span>
    <span class=pc8 title="line 19 char 1 count 1">[else "unknown"]))</span>

<span class=pc8 title="line 16 char 1 count 1">(define blodwen-lazy</span>
  <span class=pc8 title="line 30 char 3 count 1">(lambda (f)</span>
    <span class=pc8 title="line 30 char 3 count 1">(let ([evaluated #f] [res void])</span>
      <span class=pc8 title="line 30 char 3 count 1">(lambda ()</span>
        <span class=pc8 title="line 30 char 3 count 1">(if (not evaluated)</span>
            <span class=pc8 title="line 30 char 3 count 1">(begin (set! evaluated #t)</span>
                   <span class=pc8 title="line 30 char 3 count 1">(set! res (f))</span>
                   <span class=pc8 title="line 30 char 3 count 1">(set! f void))</span>
            <span class=pc8 title="line 30 char 3 count 1">(void))</span>
        <span class=pc8 title="line 30 char 3 count 1">res)))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 40 char 1 count 1">(define (blodwen-delay-lazy f)</span>
  <span class=pc8 title="line 40 char 1 count 1">(weak-cons #!bwp f))</span>

<span class=pc8 title="line 43 char 1 count 1">(define (blodwen-force-lazy e)</span>
  <span class=pc8 title="line 43 char 1 count 1">(let ((exval (car e)))</span>
    <span class=pc8 title="line 43 char 1 count 1">(if (bwp-object? exval)</span>
      <span class=pc8 title="line 43 char 1 count 1">(let ((val ((cdr e))))</span>
        <span class=pc8 title="line 43 char 1 count 1">(begin (set-car! e val) val))</span>
      <span class=pc8 title="line 43 char 1 count 1">exval)))</span>

<span class=pc8 title="line 50 char 1 count 1">(define (blodwen-toSignedInt x bits)</span>
  <span class=pc12 title="line 51 char 3 count 12">(if </span><span class=pc12 title="line 51 char 7 count 12">(</span><span class=pc12 title="line 51 char 8 count 12">logbit?</span><span class=pc12 title="line 51 char 7 count 12"> </span><span class=pc12 title="line 51 char 16 count 12">bits</span><span class=pc12 title="line 51 char 7 count 12"> </span><span class=pc12 title="line 51 char 21 count 12">x</span><span class=pc12 title="line 51 char 7 count 12">)</span>
      <span class=pc1 title="line 52 char 7 count 0">(</span><span class=pc1 title="line 52 char 8 count 0">logor</span><span class=pc1 title="line 52 char 7 count 0"> </span><span class=pc1 title="line 52 char 14 count 0">x</span><span class=pc1 title="line 52 char 7 count 0"> </span><span class=pc1 title="line 52 char 16 count 0">(</span><span class=pc1 title="line 52 char 17 count 0">ash</span><span class=pc1 title="line 52 char 16 count 0"> </span><span class=pc1 title="line 52 char 21 count 0">-1</span><span class=pc1 title="line 52 char 16 count 0"> </span><span class=pc1 title="line 52 char 24 count 0">bits</span><span class=pc1 title="line 52 char 16 count 0">)</span><span class=pc1 title="line 52 char 7 count 0">)</span>
      <span class=pc12 title="line 53 char 7 count 12">(</span><span class=pc12 title="line 53 char 8 count 12">logand</span><span class=pc12 title="line 53 char 7 count 12"> </span><span class=pc12 title="line 53 char 15 count 12">x</span><span class=pc12 title="line 53 char 7 count 12"> </span><span class=pc12 title="line 53 char 17 count 12">(</span><span class=pc12 title="line 53 char 18 count 12">sub1</span><span class=pc12 title="line 53 char 17 count 12"> </span><span class=pc12 title="line 53 char 23 count 12">(</span><span class=pc12 title="line 53 char 24 count 12">ash</span><span class=pc12 title="line 53 char 23 count 12"> </span><span class=pc12 title="line 53 char 28 count 12">1</span><span class=pc12 title="line 53 char 23 count 12"> </span><span class=pc12 title="line 53 char 30 count 12">bits</span><span class=pc12 title="line 53 char 23 count 12">)</span><span class=pc12 title="line 53 char 17 count 12">)</span><span class=pc12 title="line 53 char 7 count 12">)</span><span class=pc12 title="line 51 char 3 count 12">)</span><span class=pc8 title="line 50 char 1 count 1">)</span>

<span class=pc8 title="line 55 char 1 count 1">(define (blodwen-toUnsignedInt x bits)</span>
  <span class=pc8 title="line 55 char 1 count 1">(logand x (sub1 (ash 1 bits))))</span>

<span class=pc8 title="line 58 char 1 count 1">(define (blodwen-euclidDiv a b)</span>
  <span class=pc8 title="line 58 char 1 count 1">(let ((q (quotient a b))</span>
        <span class=pc8 title="line 58 char 1 count 1">(r (remainder a b)))</span>
    <span class=pc8 title="line 58 char 1 count 1">(if (&lt; r 0)</span>
      <span class=pc8 title="line 58 char 1 count 1">(if (&gt; b 0) (- q 1) (+ q 1))</span>
      <span class=pc8 title="line 58 char 1 count 1">q)))</span>

<span class=pc8 title="line 65 char 1 count 1">(define (blodwen-euclidMod a b)</span>
  <span class=pc8 title="line 65 char 1 count 1">(let ((r (remainder a b)))</span>
    <span class=pc8 title="line 65 char 1 count 1">(if (&lt; r 0)</span>
      <span class=pc8 title="line 65 char 1 count 1">(if (&gt; b 0) (+ r b) (- r b))</span>
      <span class=pc8 title="line 65 char 1 count 1">r)))</span>

<span class=pc8 title="line 16 char 1 count 1">; flonum constants</span>

<span class=pc8 title="line 73 char 1 count 1">(define (blodwen-calcFlonumUnitRoundoff)</span>
  <span class=pc8 title="line 73 char 1 count 1">(let loop [(uro 1.0)]</span>
    <span class=pc8 title="line 73 char 1 count 1">(if (fl= 1.0 (fl+ 1.0 uro))</span>
      <span class=pc8 title="line 73 char 1 count 1">uro</span>
      <span class=pc8 title="line 73 char 1 count 1">(loop (fl/ uro 2.0)))))</span>

<span class=pc8 title="line 79 char 1 count 1">(define (blodwen-calcFlonumEpsilon)</span>
  <span class=pc8 title="line 79 char 1 count 1">(fl* (blodwen-calcFlonumUnitRoundoff) 2.0))</span>

<span class=pc8 title="line 82 char 1 count 1">(define (blodwen-flonumNaN)</span>
  <span class=pc8 title="line 82 char 1 count 1">+nan.0)</span>

<span class=pc8 title="line 85 char 1 count 1">(define (blodwen-flonumInf)</span>
  <span class=pc8 title="line 85 char 1 count 1">+inf.0)</span>

<span class=pc8 title="line 16 char 1 count 1">; Bits</span>

<span class=pc8 title="line 16 char 1 count 1">(define bu+ </span><span class=pc8 title="line 90 char 13 count 1">(lambda (x y bits) (blodwen-toUnsignedInt (+ x y) bits))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define bu- </span><span class=pc8 title="line 91 char 13 count 1">(lambda (x y bits) (blodwen-toUnsignedInt (- x y) bits))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define bu* </span><span class=pc8 title="line 92 char 13 count 1">(lambda (x y bits) (blodwen-toUnsignedInt (* x y) bits))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define bu/ </span><span class=pc8 title="line 93 char 13 count 1">(lambda (x y bits) (blodwen-toUnsignedInt (quotient x y) bits))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define bs+ </span><span class=pc8 title="line 95 char 13 count 1">(lambda (x y bits) </span><span class=pc8 title="line 95 char 32 count 1">(</span><span class=pc8 title="line 95 char 33 count 1">blodwen-toSignedInt</span><span class=pc8 title="line 95 char 32 count 1"> </span><span class=pc8 title="line 95 char 53 count 1">(</span><span class=pc8 title="line 95 char 54 count 1">+</span><span class=pc8 title="line 95 char 53 count 1"> </span><span class=pc8 title="line 95 char 56 count 1">x</span><span class=pc8 title="line 95 char 53 count 1"> </span><span class=pc8 title="line 95 char 58 count 1">y</span><span class=pc8 title="line 95 char 53 count 1">)</span><span class=pc8 title="line 95 char 32 count 1"> </span><span class=pc8 title="line 95 char 61 count 1">bits</span><span class=pc8 title="line 95 char 32 count 1">)</span><span class=pc8 title="line 95 char 13 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define bs- </span><span class=pc8 title="line 96 char 13 count 1">(lambda (x y bits) </span><span class=pc10 title="line 96 char 32 count 5">(</span><span class=pc10 title="line 96 char 33 count 5">blodwen-toSignedInt</span><span class=pc10 title="line 96 char 32 count 5"> </span><span class=pc10 title="line 96 char 53 count 5">(</span><span class=pc10 title="line 96 char 54 count 5">-</span><span class=pc10 title="line 96 char 53 count 5"> </span><span class=pc10 title="line 96 char 56 count 5">x</span><span class=pc10 title="line 96 char 53 count 5"> </span><span class=pc10 title="line 96 char 58 count 5">y</span><span class=pc10 title="line 96 char 53 count 5">)</span><span class=pc10 title="line 96 char 32 count 5"> </span><span class=pc10 title="line 96 char 61 count 5">bits</span><span class=pc10 title="line 96 char 32 count 5">)</span><span class=pc8 title="line 96 char 13 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define bs* </span><span class=pc8 title="line 97 char 13 count 1">(lambda (x y bits) </span><span class=pc11 title="line 97 char 32 count 6">(</span><span class=pc11 title="line 97 char 33 count 6">blodwen-toSignedInt</span><span class=pc11 title="line 97 char 32 count 6"> </span><span class=pc11 title="line 97 char 53 count 6">(</span><span class=pc11 title="line 97 char 54 count 6">*</span><span class=pc11 title="line 97 char 53 count 6"> </span><span class=pc11 title="line 97 char 56 count 6">x</span><span class=pc11 title="line 97 char 53 count 6"> </span><span class=pc11 title="line 97 char 58 count 6">y</span><span class=pc11 title="line 97 char 53 count 6">)</span><span class=pc11 title="line 97 char 32 count 6"> </span><span class=pc11 title="line 97 char 61 count 6">bits</span><span class=pc11 title="line 97 char 32 count 6">)</span><span class=pc8 title="line 97 char 13 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define bs/ </span><span class=pc8 title="line 98 char 13 count 1">(lambda (x y bits) (blodwen-toSignedInt (blodwen-euclidDiv x y) bits))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 100 char 1 count 1">(define (integer-&gt;bits8 x) (logand x (sub1 (ash 1 8))))</span>
<span class=pc8 title="line 101 char 1 count 1">(define (integer-&gt;bits16 x) (logand x (sub1 (ash 1 16))))</span>
<span class=pc8 title="line 102 char 1 count 1">(define (integer-&gt;bits32 x) (logand x (sub1 (ash 1 32))))</span>
<span class=pc8 title="line 103 char 1 count 1">(define (integer-&gt;bits64 x) (logand x (sub1 (ash 1 64))))</span>

<span class=pc8 title="line 105 char 1 count 1">(define (bits16-&gt;bits8 x) (logand x (sub1 (ash 1 8))))</span>
<span class=pc8 title="line 106 char 1 count 1">(define (bits32-&gt;bits8 x) (logand x (sub1 (ash 1 8))))</span>
<span class=pc8 title="line 107 char 1 count 1">(define (bits64-&gt;bits8 x) (logand x (sub1 (ash 1 8))))</span>
<span class=pc8 title="line 108 char 1 count 1">(define (bits32-&gt;bits16 x) (logand x (sub1 (ash 1 16))))</span>
<span class=pc8 title="line 109 char 1 count 1">(define (bits64-&gt;bits16 x) (logand x (sub1 (ash 1 16))))</span>
<span class=pc8 title="line 110 char 1 count 1">(define (bits64-&gt;bits32 x) (logand x (sub1 (ash 1 32))))</span>

<span class=pc8 title="line 112 char 1 count 1">(define (blodwen-bits-shl-signed x y bits) (blodwen-toSignedInt (ash x y) bits))</span>

<span class=pc8 title="line 114 char 1 count 1">(define (blodwen-bits-shl x y bits) (logand (ash x y) (sub1 (ash 1 bits))))</span>

<span class=pc8 title="line 16 char 1 count 1">(define blodwen-shl </span><span class=pc8 title="line 116 char 21 count 1">(lambda (x y) (ash x y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define blodwen-shr </span><span class=pc8 title="line 117 char 21 count 1">(lambda (x y) (ash x (- y)))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define blodwen-and </span><span class=pc8 title="line 118 char 21 count 1">(lambda (x y) (logand x y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define blodwen-or </span><span class=pc8 title="line 119 char 20 count 1">(lambda (x y) (logor x y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define blodwen-xor </span><span class=pc8 title="line 120 char 21 count 1">(lambda (x y) (logxor x y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define cast-num</span>
  <span class=pc8 title="line 123 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 123 char 3 count 1">(if (number? x) x 0))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define destroy-prefix</span>
  <span class=pc8 title="line 126 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 126 char 3 count 1">(cond</span>
      <span class=pc8 title="line 126 char 3 count 1">((equal? x "") "")</span>
      <span class=pc8 title="line 126 char 3 count 1">((equal? (string-ref x 0) #\#) "")</span>
      <span class=pc8 title="line 126 char 3 count 1">(else x)))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define exact-floor</span>
  <span class=pc8 title="line 133 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 133 char 3 count 1">(inexact-&gt;exact (floor x)))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define exact-truncate</span>
  <span class=pc8 title="line 137 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 137 char 3 count 1">(inexact-&gt;exact (truncate x)))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define exact-truncate-boundedInt</span>
  <span class=pc8 title="line 141 char 3 count 1">(lambda (x y)</span>
    <span class=pc8 title="line 141 char 3 count 1">(blodwen-toSignedInt (exact-truncate x) y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define exact-truncate-boundedUInt</span>
  <span class=pc8 title="line 145 char 3 count 1">(lambda (x y)</span>
    <span class=pc8 title="line 145 char 3 count 1">(blodwen-toUnsignedInt (exact-truncate x) y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define cast-char-boundedInt</span>
  <span class=pc8 title="line 149 char 3 count 1">(lambda (x y)</span>
    <span class=pc8 title="line 149 char 3 count 1">(blodwen-toSignedInt (char-&gt;integer x) y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define cast-char-boundedUInt</span>
  <span class=pc8 title="line 153 char 3 count 1">(lambda (x y)</span>
    <span class=pc8 title="line 153 char 3 count 1">(blodwen-toUnsignedInt (char-&gt;integer x) y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define cast-string-int</span>
  <span class=pc8 title="line 157 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 157 char 3 count 1">(exact-truncate (cast-num (string-&gt;number (destroy-prefix x)))))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define cast-string-boundedInt</span>
  <span class=pc8 title="line 161 char 3 count 1">(lambda (x y)</span>
    <span class=pc8 title="line 161 char 3 count 1">(blodwen-toSignedInt (cast-string-int x) y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define cast-string-boundedUInt</span>
  <span class=pc8 title="line 165 char 3 count 1">(lambda (x y)</span>
    <span class=pc8 title="line 165 char 3 count 1">(blodwen-toUnsignedInt (cast-string-int x) y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define cast-int-char</span>
  <span class=pc8 title="line 169 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 169 char 3 count 1">(if (or</span>
          <span class=pc8 title="line 169 char 3 count 1">(and (&gt;= x 0) (&lt;= x #xd7ff))</span>
          <span class=pc8 title="line 169 char 3 count 1">(and (&gt;= x #xe000) (&lt;= x #x10ffff)))</span>
        <span class=pc8 title="line 169 char 3 count 1">(integer-&gt;char x)</span>
        <span class=pc8 title="line 169 char 3 count 1">(integer-&gt;char 0)))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define cast-string-double</span>
  <span class=pc8 title="line 177 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 177 char 3 count 1">(exact-&gt;inexact (cast-num (string-&gt;number (destroy-prefix x)))))</span><span class=pc8 title="line 16 char 1 count 1">)</span>


<span class=pc8 title="line 181 char 1 count 1">(define (string-concat xs) (apply string-append xs))</span>
<span class=pc8 title="line 182 char 1 count 1">(define (string-unpack s) (string-&gt;list s))</span>
<span class=pc8 title="line 183 char 1 count 1">(define (string-pack xs) (list-&gt;string xs))</span>

<span class=pc8 title="line 16 char 1 count 1">(define string-cons </span><span class=pc8 title="line 185 char 21 count 1">(lambda (x y) (string-append (string x) y))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define string-reverse </span><span class=pc8 title="line 186 char 24 count 1">(lambda (x)</span>
  <span class=pc8 title="line 186 char 24 count 1">(list-&gt;string (reverse (string-&gt;list x))))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 188 char 1 count 1">(define (string-substr off len s)</span>
    <span class=pc8 title="line 188 char 1 count 1">(let* ((l (string-length s))</span>
          <span class=pc8 title="line 188 char 1 count 1">(b (max 0 off))</span>
          <span class=pc8 title="line 188 char 1 count 1">(x (max 0 len))</span>
          <span class=pc8 title="line 188 char 1 count 1">(end (min l (+ b x))))</span>
          <span class=pc8 title="line 188 char 1 count 1">(if (&gt; b l)</span>
              <span class=pc8 title="line 188 char 1 count 1">""</span>
              <span class=pc8 title="line 188 char 1 count 1">(substring s b end))))</span>

<span class=pc8 title="line 197 char 1 count 1">(define (blodwen-string-iterator-new s)</span>
  <span class=pc8 title="line 197 char 1 count 1">0)</span>

<span class=pc8 title="line 200 char 1 count 1">(define (blodwen-string-iterator-to-string _ s ofs f)</span>
  <span class=pc8 title="line 200 char 1 count 1">(f (substring s ofs (string-length s))))</span>

<span class=pc8 title="line 203 char 1 count 1">(define (blodwen-string-iterator-next s ofs)</span>
  <span class=pc8 title="line 203 char 1 count 1">(if (&gt;= ofs (string-length s))</span>
      <span class=pc8 title="line 203 char 1 count 1">'() ; EOF</span>
      <span class=pc8 title="line 203 char 1 count 1">(cons (string-ref s ofs) (+ ofs 1))))</span>

<span class=pc8 title="line 16 char 1 count 1">(define either-left</span>
  <span class=pc8 title="line 209 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 209 char 3 count 1">(vector 0 x))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define either-right</span>
  <span class=pc8 title="line 213 char 3 count 1">(lambda (x)</span>
    <span class=pc8 title="line 213 char 3 count 1">(vector 1 x))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">(define blodwen-error-quit</span>
  <span class=pc8 title="line 217 char 3 count 1">(lambda (msg)</span>
    <span class=pc8 title="line 217 char 3 count 1">(display msg)</span>
    <span class=pc8 title="line 217 char 3 count 1">(newline)</span>
    <span class=pc8 title="line 217 char 3 count 1">(exit 1))</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 222 char 1 count 1">(define (blodwen-get-line p)</span>
    <span class=pc8 title="line 222 char 1 count 1">(if (port? p)</span>
        <span class=pc8 title="line 222 char 1 count 1">(let ((str (get-line p)))</span>
            <span class=pc8 title="line 222 char 1 count 1">(if (eof-object? str)</span>
                <span class=pc8 title="line 222 char 1 count 1">""</span>
                <span class=pc8 title="line 222 char 1 count 1">str))</span>
        <span class=pc8 title="line 222 char 1 count 1">void))</span>

<span class=pc8 title="line 230 char 1 count 1">(define (blodwen-get-char p)</span>
    <span class=pc8 title="line 230 char 1 count 1">(if (port? p)</span>
        <span class=pc8 title="line 230 char 1 count 1">(let ((chr (get-char p)))</span>
            <span class=pc8 title="line 230 char 1 count 1">(if (eof-object? chr)</span>
                <span class=pc8 title="line 230 char 1 count 1">#\nul</span>
                <span class=pc8 title="line 230 char 1 count 1">chr))</span>
        <span class=pc8 title="line 230 char 1 count 1">void))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Buffers</span>

<span class=pc8 title="line 240 char 1 count 1">(define (blodwen-new-buffer size)</span>
  <span class=pc8 title="line 240 char 1 count 1">(make-bytevector size 0))</span>

<span class=pc8 title="line 243 char 1 count 1">(define (blodwen-buffer-size buf)</span>
  <span class=pc8 title="line 243 char 1 count 1">(bytevector-length buf))</span>

<span class=pc8 title="line 246 char 1 count 1">(define (blodwen-buffer-setbyte buf loc val)</span>
  <span class=pc8 title="line 246 char 1 count 1">(bytevector-u8-set! buf loc val))</span>

<span class=pc8 title="line 249 char 1 count 1">(define (blodwen-buffer-getbyte buf loc)</span>
  <span class=pc8 title="line 249 char 1 count 1">(bytevector-u8-ref buf loc))</span>

<span class=pc8 title="line 252 char 1 count 1">(define (blodwen-buffer-setbits16 buf loc val)</span>
  <span class=pc8 title="line 252 char 1 count 1">(bytevector-u16-set! buf loc val (native-endianness)))</span>

<span class=pc8 title="line 255 char 1 count 1">(define (blodwen-buffer-getbits16 buf loc)</span>
  <span class=pc8 title="line 255 char 1 count 1">(bytevector-u16-ref buf loc (native-endianness)))</span>

<span class=pc8 title="line 258 char 1 count 1">(define (blodwen-buffer-setbits32 buf loc val)</span>
  <span class=pc8 title="line 258 char 1 count 1">(bytevector-u32-set! buf loc val (native-endianness)))</span>

<span class=pc8 title="line 261 char 1 count 1">(define (blodwen-buffer-getbits32 buf loc)</span>
  <span class=pc8 title="line 261 char 1 count 1">(bytevector-u32-ref buf loc (native-endianness)))</span>

<span class=pc8 title="line 264 char 1 count 1">(define (blodwen-buffer-setbits64 buf loc val)</span>
  <span class=pc8 title="line 264 char 1 count 1">(bytevector-u64-set! buf loc val (native-endianness)))</span>

<span class=pc8 title="line 267 char 1 count 1">(define (blodwen-buffer-getbits64 buf loc)</span>
  <span class=pc8 title="line 267 char 1 count 1">(bytevector-u64-ref buf loc (native-endianness)))</span>

<span class=pc8 title="line 270 char 1 count 1">(define (blodwen-buffer-setint8 buf loc val)</span>
  <span class=pc8 title="line 270 char 1 count 1">(bytevector-s8-set! buf loc val))</span>

<span class=pc8 title="line 273 char 1 count 1">(define (blodwen-buffer-getint8 buf loc)</span>
  <span class=pc8 title="line 273 char 1 count 1">(bytevector-s8-ref buf loc))</span>

<span class=pc8 title="line 276 char 1 count 1">(define (blodwen-buffer-setint16 buf loc val)</span>
  <span class=pc8 title="line 276 char 1 count 1">(bytevector-s16-set! buf loc val (native-endianness)))</span>

<span class=pc8 title="line 279 char 1 count 1">(define (blodwen-buffer-getint16 buf loc)</span>
  <span class=pc8 title="line 279 char 1 count 1">(bytevector-s16-ref buf loc (native-endianness)))</span>

<span class=pc8 title="line 282 char 1 count 1">(define (blodwen-buffer-setint32 buf loc val)</span>
  <span class=pc8 title="line 282 char 1 count 1">(bytevector-s32-set! buf loc val (native-endianness)))</span>

<span class=pc8 title="line 285 char 1 count 1">(define (blodwen-buffer-getint32 buf loc)</span>
  <span class=pc8 title="line 285 char 1 count 1">(bytevector-s32-ref buf loc (native-endianness)))</span>

<span class=pc8 title="line 288 char 1 count 1">(define (blodwen-buffer-setint buf loc val)</span>
  <span class=pc8 title="line 288 char 1 count 1">(bytevector-s64-set! buf loc val (native-endianness)))</span>

<span class=pc8 title="line 291 char 1 count 1">(define (blodwen-buffer-getint buf loc)</span>
  <span class=pc8 title="line 291 char 1 count 1">(bytevector-s64-ref buf loc (native-endianness)))</span>

<span class=pc8 title="line 294 char 1 count 1">(define (blodwen-buffer-setint64 buf loc val)</span>
  <span class=pc8 title="line 294 char 1 count 1">(bytevector-s64-set! buf loc val (native-endianness)))</span>

<span class=pc8 title="line 297 char 1 count 1">(define (blodwen-buffer-getint64 buf loc)</span>
  <span class=pc8 title="line 297 char 1 count 1">(bytevector-s64-ref buf loc (native-endianness)))</span>

<span class=pc8 title="line 300 char 1 count 1">(define (blodwen-buffer-setdouble buf loc val)</span>
  <span class=pc8 title="line 300 char 1 count 1">(bytevector-ieee-double-set! buf loc val (native-endianness)))</span>

<span class=pc8 title="line 303 char 1 count 1">(define (blodwen-buffer-getdouble buf loc)</span>
  <span class=pc8 title="line 303 char 1 count 1">(bytevector-ieee-double-ref buf loc (native-endianness)))</span>

<span class=pc8 title="line 306 char 1 count 1">(define (blodwen-stringbytelen str)</span>
  <span class=pc8 title="line 306 char 1 count 1">(bytevector-length (string-&gt;utf8 str)))</span>

<span class=pc8 title="line 309 char 1 count 1">(define (blodwen-buffer-setstring buf loc val)</span>
  <span class=pc8 title="line 309 char 1 count 1">(let* [(strvec (string-&gt;utf8 val))</span>
         <span class=pc8 title="line 309 char 1 count 1">(len (bytevector-length strvec))]</span>
    <span class=pc8 title="line 309 char 1 count 1">(bytevector-copy! strvec 0 buf loc len)))</span>

<span class=pc8 title="line 314 char 1 count 1">(define (blodwen-buffer-getstring buf loc len)</span>
  <span class=pc8 title="line 314 char 1 count 1">(let [(newvec (make-bytevector len))]</span>
    <span class=pc8 title="line 314 char 1 count 1">(bytevector-copy! buf loc newvec 0 len)</span>
    <span class=pc8 title="line 314 char 1 count 1">(utf8-&gt;string newvec)))</span>

<span class=pc8 title="line 319 char 1 count 1">(define (blodwen-buffer-copydata buf start len dest loc)</span>
  <span class=pc8 title="line 319 char 1 count 1">(bytevector-copy! buf start dest loc len))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Threads</span>

<span class=pc8 title="line 16 char 1 count 1">(define-record thread-handle (semaphore))</span>

<span class=pc8 title="line 326 char 1 count 1">(define (blodwen-thread proc)</span>
  <span class=pc8 title="line 326 char 1 count 1">(let [(sema (blodwen-make-semaphore 0))]</span>
    <span class=pc8 title="line 326 char 1 count 1">(fork-thread (lambda () (proc (vector 0)) (blodwen-semaphore-post sema)))</span>
    <span class=pc8 title="line 326 char 1 count 1">(make-thread-handle sema)</span>
    <span class=pc8 title="line 326 char 1 count 1">))</span>

<span class=pc8 title="line 332 char 1 count 1">(define (blodwen-thread-wait handle)</span>
  <span class=pc8 title="line 332 char 1 count 1">(blodwen-semaphore-wait (thread-handle-semaphore handle)))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Thread mailboxes</span>

<span class=pc8 title="line 16 char 1 count 1">(define blodwen-thread-data</span>
  <span class=pc8 title="line 338 char 3 count 1">(</span><span class=pc8 title="line 338 char 4 count 1">make-thread-parameter</span><span class=pc8 title="line 338 char 3 count 1"> </span><span class=pc8 title="line 338 char 26 count 1">#f</span><span class=pc8 title="line 338 char 3 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 340 char 1 count 1">(define (blodwen-get-thread-data ty)</span>
  <span class=pc8 title="line 340 char 1 count 1">(blodwen-thread-data))</span>

<span class=pc8 title="line 343 char 1 count 1">(define (blodwen-set-thread-data ty a)</span>
  <span class=pc8 title="line 343 char 1 count 1">(blodwen-thread-data a))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Semaphore</span>

<span class=pc8 title="line 16 char 1 count 1">(define-record semaphore (box mutex condition))</span>

<span class=pc8 title="line 350 char 1 count 1">(define (blodwen-make-semaphore init)</span>
  <span class=pc8 title="line 350 char 1 count 1">(make-semaphore (box init) (make-mutex) (make-condition)))</span>

<span class=pc8 title="line 353 char 1 count 1">(define (blodwen-semaphore-post sema)</span>
  <span class=pc8 title="line 353 char 1 count 1">(with-mutex (semaphore-mutex sema)</span>
    <span class=pc8 title="line 353 char 1 count 1">(let [(sema-box (semaphore-box sema))]</span>
      <span class=pc8 title="line 353 char 1 count 1">(set-box! sema-box (+ (unbox sema-box) 1))</span>
      <span class=pc8 title="line 353 char 1 count 1">(condition-signal (semaphore-condition sema))</span>
    <span class=pc8 title="line 353 char 1 count 1">)))</span>

<span class=pc8 title="line 360 char 1 count 1">(define (blodwen-semaphore-wait sema)</span>
  <span class=pc8 title="line 360 char 1 count 1">(with-mutex (semaphore-mutex sema)</span>
    <span class=pc8 title="line 360 char 1 count 1">(let [(sema-box (semaphore-box sema))]</span>
      <span class=pc8 title="line 360 char 1 count 1">(when (= (unbox sema-box) 0)</span>
        <span class=pc8 title="line 360 char 1 count 1">(condition-wait (semaphore-condition sema) (semaphore-mutex sema)))</span>
      <span class=pc8 title="line 360 char 1 count 1">(set-box! sema-box (- (unbox sema-box) 1))</span>
      <span class=pc8 title="line 360 char 1 count 1">)))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Barrier</span>

<span class=pc8 title="line 16 char 1 count 1">(define-record barrier (count-box num-threads mutex cond))</span>

<span class=pc8 title="line 372 char 1 count 1">(define (blodwen-make-barrier num-threads)</span>
  <span class=pc8 title="line 372 char 1 count 1">(make-barrier (box 0) num-threads (make-mutex) (make-condition)))</span>

<span class=pc8 title="line 375 char 1 count 1">(define (blodwen-barrier-wait barrier)</span>
  <span class=pc8 title="line 375 char 1 count 1">(let [(count-box (barrier-count-box barrier))</span>
        <span class=pc8 title="line 375 char 1 count 1">(num-threads (barrier-num-threads barrier))</span>
        <span class=pc8 title="line 375 char 1 count 1">(mutex (barrier-mutex barrier))</span>
        <span class=pc8 title="line 375 char 1 count 1">(condition (barrier-cond barrier))]</span>
    <span class=pc8 title="line 375 char 1 count 1">(with-mutex mutex</span>
    <span class=pc8 title="line 375 char 1 count 1">(let* [(count-old (unbox count-box))</span>
           <span class=pc8 title="line 375 char 1 count 1">(count-new (+ count-old 1))]</span>
      <span class=pc8 title="line 375 char 1 count 1">(set-box! count-box count-new)</span>
      <span class=pc8 title="line 375 char 1 count 1">(if (= count-new num-threads)</span>
          <span class=pc8 title="line 375 char 1 count 1">(condition-broadcast condition)</span>
          <span class=pc8 title="line 375 char 1 count 1">(condition-wait condition mutex))</span>
      <span class=pc8 title="line 375 char 1 count 1">))))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Channel</span>
<span class=pc8 title="line 16 char 1 count 1">; With thanks to Alain Zscheile (@zseri) for help with understanding condition</span>
<span class=pc8 title="line 16 char 1 count 1">; variables, and figuring out where the problems were and how to solve them.</span>

<span class=pc8 title="line 16 char 1 count 1">(define-record channel (read-mut read-cv read-box val-cv val-box))</span>

<span class=pc8 title="line 395 char 1 count 1">(define (blodwen-make-channel ty)</span>
  <span class=pc8 title="line 395 char 1 count 1">(make-channel</span>
    <span class=pc8 title="line 395 char 1 count 1">(make-mutex)</span>
    <span class=pc8 title="line 395 char 1 count 1">(make-condition)</span>
    <span class=pc8 title="line 395 char 1 count 1">(box #t)</span>
    <span class=pc8 title="line 395 char 1 count 1">(make-condition)</span>
    <span class=pc8 title="line 395 char 1 count 1">(box '())</span>
    <span class=pc8 title="line 395 char 1 count 1">))</span>

<span class=pc8 title="line 16 char 1 count 1">; block on the read status using read-cv until the value has been read</span>
<span class=pc8 title="line 405 char 1 count 1">(define (channel-put-while-helper chan)</span>
  <span class=pc8 title="line 405 char 1 count 1">(let ([read-mut (channel-read-mut chan)]</span>
        <span class=pc8 title="line 405 char 1 count 1">[read-box (channel-read-box chan)]</span>
        <span class=pc8 title="line 405 char 1 count 1">[read-cv  (channel-read-cv  chan)]</span>
        <span class=pc8 title="line 405 char 1 count 1">)</span>
    <span class=pc8 title="line 405 char 1 count 1">(if (unbox read-box)</span>
      <span class=pc8 title="line 405 char 1 count 1">(void)    ; val has been read, so everything is fine</span>
      <span class=pc8 title="line 405 char 1 count 1">(begin    ; otherwise, block/spin with cv</span>
        <span class=pc8 title="line 405 char 1 count 1">(condition-wait read-cv read-mut)</span>
        <span class=pc8 title="line 405 char 1 count 1">(channel-put-while-helper chan)</span>
        <span class=pc8 title="line 405 char 1 count 1">)</span>
      <span class=pc8 title="line 405 char 1 count 1">)))</span>

<span class=pc8 title="line 418 char 1 count 1">(define (blodwen-channel-put ty chan val)</span>
  <span class=pc8 title="line 418 char 1 count 1">(with-mutex (channel-read-mut chan)</span>
    <span class=pc8 title="line 418 char 1 count 1">(channel-put-while-helper chan)</span>
    <span class=pc8 title="line 418 char 1 count 1">(let ([read-box (channel-read-box chan)]</span>
          <span class=pc8 title="line 418 char 1 count 1">[val-box  (channel-val-box  chan)]</span>
          <span class=pc8 title="line 418 char 1 count 1">)</span>
      <span class=pc8 title="line 418 char 1 count 1">(set-box! val-box val)</span>
      <span class=pc8 title="line 418 char 1 count 1">(set-box! read-box #f)</span>
      <span class=pc8 title="line 418 char 1 count 1">))</span>
  <span class=pc8 title="line 418 char 1 count 1">(condition-signal (channel-val-cv chan))</span>
  <span class=pc8 title="line 418 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">; block on the value until it has been set</span>
<span class=pc8 title="line 431 char 1 count 1">(define (channel-get-while-helper chan)</span>
  <span class=pc8 title="line 431 char 1 count 1">(let ([read-mut (channel-read-mut chan)]</span>
        <span class=pc8 title="line 431 char 1 count 1">[read-box (channel-read-box chan)]</span>
        <span class=pc8 title="line 431 char 1 count 1">[val-cv   (channel-val-cv   chan)]</span>
        <span class=pc8 title="line 431 char 1 count 1">)</span>
    <span class=pc8 title="line 431 char 1 count 1">(if (unbox read-box)</span>
      <span class=pc8 title="line 431 char 1 count 1">(begin</span>
        <span class=pc8 title="line 431 char 1 count 1">(condition-wait val-cv read-mut)</span>
        <span class=pc8 title="line 431 char 1 count 1">(channel-get-while-helper chan)</span>
        <span class=pc8 title="line 431 char 1 count 1">)</span>
      <span class=pc8 title="line 431 char 1 count 1">(void)</span>
      <span class=pc8 title="line 431 char 1 count 1">)))</span>

<span class=pc8 title="line 444 char 1 count 1">(define (blodwen-channel-get ty chan)</span>
  <span class=pc8 title="line 444 char 1 count 1">(mutex-acquire (channel-read-mut chan))</span>
  <span class=pc8 title="line 444 char 1 count 1">(channel-get-while-helper chan)</span>
  <span class=pc8 title="line 444 char 1 count 1">(let* ([val-box  (channel-val-box  chan)]</span>
         <span class=pc8 title="line 444 char 1 count 1">[read-box (channel-read-box chan)]</span>
         <span class=pc8 title="line 444 char 1 count 1">[read-cv  (channel-read-cv  chan)]</span>
         <span class=pc8 title="line 444 char 1 count 1">[the-val  (unbox val-box)]</span>
         <span class=pc8 title="line 444 char 1 count 1">)</span>
    <span class=pc8 title="line 444 char 1 count 1">(set-box! val-box '())</span>
    <span class=pc8 title="line 444 char 1 count 1">(set-box! read-box #t)</span>
    <span class=pc8 title="line 444 char 1 count 1">(mutex-release (channel-read-mut chan))</span>
    <span class=pc8 title="line 444 char 1 count 1">(condition-signal read-cv)</span>
    <span class=pc8 title="line 444 char 1 count 1">the-val))</span>

<span class=pc8 title="line 458 char 1 count 1">(define (blodwen-channel-get-non-blocking ty chan)</span>
  <span class=pc8 title="line 458 char 1 count 1">(if (mutex-acquire (channel-read-mut chan) #f)</span>
    <span class=pc8 title="line 458 char 1 count 1">(let* ([val-box  (channel-val-box  chan)]</span>
           <span class=pc8 title="line 458 char 1 count 1">[read-box (channel-read-box chan)]</span>
           <span class=pc8 title="line 458 char 1 count 1">[read-cv  (channel-read-cv  chan)]</span>
           <span class=pc8 title="line 458 char 1 count 1">[the-val  (unbox val-box)]</span>
          <span class=pc8 title="line 458 char 1 count 1">)</span>
      <span class=pc8 title="line 458 char 1 count 1">(if (null? the-val)</span>
          <span class=pc8 title="line 458 char 1 count 1">(begin</span>
           <span class=pc8 title="line 458 char 1 count 1">(mutex-release (channel-read-mut chan))</span>
           <span class=pc8 title="line 458 char 1 count 1">'())</span>
          <span class=pc8 title="line 458 char 1 count 1">(begin</span>
            <span class=pc8 title="line 458 char 1 count 1">(set-box! val-box '())</span>
            <span class=pc8 title="line 458 char 1 count 1">(set-box! read-box #t)</span>
            <span class=pc8 title="line 458 char 1 count 1">(mutex-release (channel-read-mut chan))</span>
            <span class=pc8 title="line 458 char 1 count 1">(condition-signal read-cv)</span>
            <span class=pc8 title="line 458 char 1 count 1">(box the-val))</span>
      <span class=pc8 title="line 458 char 1 count 1">))</span>
  <span class=pc8 title="line 458 char 1 count 1">'()))</span>

<span class=pc8 title="line 478 char 1 count 1">(define (blodwen-channel-get-with-timeout ty chan timeout)</span>
  <span class=pc8 title="line 478 char 1 count 1">;; timeout is in milliseconds, convert to nanoseconds</span>
  <span class=pc8 title="line 478 char 1 count 1">(let* ([timeout-ns (* timeout 1000000)]</span>
         <span class=pc8 title="line 478 char 1 count 1">[sleep-ns 10000] ; 10 us step</span>
         <span class=pc8 title="line 478 char 1 count 1">[sleep-time (make-time 'time-duration (mod sleep-ns 1000000000)</span>
                                                <span class=pc8 title="line 478 char 1 count 1">(div sleep-ns 1000000000))])</span>
    <span class=pc8 title="line 478 char 1 count 1">(let loop ([elapsed 0])</span>
      <span class=pc8 title="line 478 char 1 count 1">(if (mutex-acquire (channel-read-mut chan) #f)</span>
          <span class=pc8 title="line 478 char 1 count 1">(let* ([val-box  (channel-val-box chan)]</span>
                 <span class=pc8 title="line 478 char 1 count 1">[the-val  (unbox val-box)])</span>
            <span class=pc8 title="line 478 char 1 count 1">(if (null? the-val)</span>
                <span class=pc8 title="line 478 char 1 count 1">(if (&gt;= elapsed timeout-ns)</span>
                    <span class=pc8 title="line 478 char 1 count 1">(begin</span>
                      <span class=pc8 title="line 478 char 1 count 1">(mutex-release (channel-read-mut chan))</span>
                      <span class=pc8 title="line 478 char 1 count 1">'())</span>
                    <span class=pc8 title="line 478 char 1 count 1">(begin</span>
                      <span class=pc8 title="line 478 char 1 count 1">(mutex-release (channel-read-mut chan))</span>
                      <span class=pc8 title="line 478 char 1 count 1">(sleep sleep-time)</span>
                      <span class=pc8 title="line 478 char 1 count 1">(loop (+ elapsed sleep-ns))))</span>
                <span class=pc8 title="line 478 char 1 count 1">(let* ([read-box (channel-read-box chan)]</span>
                       <span class=pc8 title="line 478 char 1 count 1">[read-cv  (channel-read-cv chan)])</span>
                  <span class=pc8 title="line 478 char 1 count 1">(set-box! val-box '())</span>
                  <span class=pc8 title="line 478 char 1 count 1">(set-box! read-box #t)</span>
                  <span class=pc8 title="line 478 char 1 count 1">(mutex-release (channel-read-mut chan))</span>
                  <span class=pc8 title="line 478 char 1 count 1">(condition-signal read-cv)</span>
                  <span class=pc8 title="line 478 char 1 count 1">(box the-val))))</span>
          <span class=pc8 title="line 478 char 1 count 1">(begin</span>
            <span class=pc8 title="line 478 char 1 count 1">(sleep sleep-time)</span>
            <span class=pc8 title="line 478 char 1 count 1">(loop (+ elapsed sleep-ns)))))))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Mutex</span>

<span class=pc8 title="line 510 char 1 count 1">(define (blodwen-make-mutex)</span>
  <span class=pc8 title="line 510 char 1 count 1">(make-mutex))</span>
<span class=pc8 title="line 512 char 1 count 1">(define (blodwen-mutex-acquire mutex)</span>
  <span class=pc8 title="line 512 char 1 count 1">(mutex-acquire mutex))</span>
<span class=pc8 title="line 514 char 1 count 1">(define (blodwen-mutex-release mutex)</span>
  <span class=pc8 title="line 514 char 1 count 1">(mutex-release mutex))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Condition variable</span>

<span class=pc8 title="line 519 char 1 count 1">(define (blodwen-make-condition)</span>
  <span class=pc8 title="line 519 char 1 count 1">(make-condition))</span>
<span class=pc8 title="line 521 char 1 count 1">(define (blodwen-condition-wait condition mutex)</span>
  <span class=pc8 title="line 521 char 1 count 1">(condition-wait condition mutex))</span>
<span class=pc8 title="line 523 char 1 count 1">(define (blodwen-condition-wait-timeout condition mutex timeout)</span>
  <span class=pc8 title="line 523 char 1 count 1">(let* [(sec (div timeout 1000000))</span>
         <span class=pc8 title="line 523 char 1 count 1">(micro (mod timeout 1000000))]</span>
    <span class=pc8 title="line 523 char 1 count 1">(condition-wait condition mutex (make-time 'time-duration (* 1000 micro) sec))))</span>
<span class=pc8 title="line 527 char 1 count 1">(define (blodwen-condition-signal condition)</span>
  <span class=pc8 title="line 527 char 1 count 1">(condition-signal condition))</span>
<span class=pc8 title="line 529 char 1 count 1">(define (blodwen-condition-broadcast condition)</span>
  <span class=pc8 title="line 529 char 1 count 1">(condition-broadcast condition))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Future</span>

<span class=pc8 title="line 16 char 1 count 1">(define-record future-internal (result ready mutex signal))</span>
<span class=pc8 title="line 535 char 1 count 1">(define (blodwen-make-future ty work)</span>
  <span class=pc8 title="line 535 char 1 count 1">(let ([future (make-future-internal #f #f (make-mutex) (make-condition))])</span>
    <span class=pc8 title="line 535 char 1 count 1">(fork-thread (lambda ()</span>
      <span class=pc8 title="line 535 char 1 count 1">(let ([result (work '())])</span>
        <span class=pc8 title="line 535 char 1 count 1">(with-mutex (future-internal-mutex future)</span>
          <span class=pc8 title="line 535 char 1 count 1">(set-future-internal-result! future result)</span>
          <span class=pc8 title="line 535 char 1 count 1">(set-future-internal-ready! future #t)</span>
          <span class=pc8 title="line 535 char 1 count 1">(condition-broadcast (future-internal-signal future))))))</span>
    <span class=pc8 title="line 535 char 1 count 1">future))</span>
<span class=pc8 title="line 544 char 1 count 1">(define (blodwen-await-future ty future)</span>
  <span class=pc8 title="line 544 char 1 count 1">(let ([mutex (future-internal-mutex future)])</span>
    <span class=pc8 title="line 544 char 1 count 1">(with-mutex mutex</span>
      <span class=pc8 title="line 544 char 1 count 1">(if (not (future-internal-ready future))</span>
          <span class=pc8 title="line 544 char 1 count 1">(condition-wait (future-internal-signal future) mutex))</span>
      <span class=pc8 title="line 544 char 1 count 1">(future-internal-result future))))</span>

<span class=pc8 title="line 551 char 1 count 1">(define (blodwen-sleep s) (sleep (make-time 'time-duration 0 s)))</span>
<span class=pc8 title="line 552 char 1 count 1">(define (blodwen-usleep s)</span>
  <span class=pc8 title="line 552 char 1 count 1">(let ((sec (div s 1000000))</span>
        <span class=pc8 title="line 552 char 1 count 1">(micro (mod s 1000000)))</span>
       <span class=pc8 title="line 552 char 1 count 1">(sleep (make-time 'time-duration (* 1000 micro) sec))))</span>

<span class=pc8 title="line 557 char 1 count 1">(define (blodwen-clock-time-utc) (current-time 'time-utc))</span>
<span class=pc8 title="line 558 char 1 count 1">(define (blodwen-clock-time-monotonic) (current-time 'time-monotonic))</span>
<span class=pc8 title="line 559 char 1 count 1">(define (blodwen-clock-time-duration) (current-time 'time-duration))</span>
<span class=pc8 title="line 560 char 1 count 1">(define (blodwen-clock-time-process) (current-time 'time-process))</span>
<span class=pc8 title="line 561 char 1 count 1">(define (blodwen-clock-time-thread) (current-time 'time-thread))</span>
<span class=pc8 title="line 562 char 1 count 1">(define (blodwen-clock-time-gccpu) (current-time 'time-collector-cpu))</span>
<span class=pc8 title="line 563 char 1 count 1">(define (blodwen-clock-time-gcreal) (current-time 'time-collector-real))</span>
<span class=pc8 title="line 564 char 1 count 1">(define (blodwen-is-time? clk) (if (time? clk) 1 0))</span>
<span class=pc8 title="line 565 char 1 count 1">(define (blodwen-clock-second time) (time-second time))</span>
<span class=pc8 title="line 566 char 1 count 1">(define (blodwen-clock-nanosecond time) (time-nanosecond time))</span>

<span class=pc8 title="line 568 char 1 count 1">(define (blodwen-arg-count)</span>
  <span class=pc8 title="line 568 char 1 count 1">(length (command-line)))</span>

<span class=pc8 title="line 571 char 1 count 1">(define (blodwen-arg n)</span>
  <span class=pc8 title="line 571 char 1 count 1">(if (&lt; n (length (command-line))) (list-ref (command-line) n) ""))</span>

<span class=pc8 title="line 574 char 1 count 1">(define (blodwen-hasenv var)</span>
  <span class=pc8 title="line 574 char 1 count 1">(if (eq? (getenv var) #f) 0 1))</span>

<span class=pc8 title="line 16 char 1 count 1">;; Randoms</span>
<span class=pc8 title="line 16 char 1 count 1">(define random-seed-register </span><span class=pc8 title="line 578 char 30 count 1">0</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 579 char 1 count 1">(define (initialize-random-seed-once)</span>
  <span class=pc8 title="line 579 char 1 count 1">(if (= (virtual-register random-seed-register) 0)</span>
      <span class=pc8 title="line 579 char 1 count 1">(let ([seed (time-nanosecond (current-time))])</span>
        <span class=pc8 title="line 579 char 1 count 1">(set-virtual-register! random-seed-register seed)</span>
        <span class=pc8 title="line 579 char 1 count 1">(random-seed seed))))</span>

<span class=pc8 title="line 585 char 1 count 1">(define (blodwen-random-seed seed)</span>
  <span class=pc8 title="line 585 char 1 count 1">(set-virtual-register! random-seed-register seed)</span>
  <span class=pc8 title="line 585 char 1 count 1">(random-seed seed))</span>
<span class=pc8 title="line 16 char 1 count 1">(define blodwen-random</span>
  <span class=pc8 title="line 589 char 3 count 1">(case-lambda</span>
    <span class=pc8 title="line 589 char 3 count 1">;; no argument, pick a real value from [0, 1.0)</span>
    <span class=pc8 title="line 589 char 3 count 1">[() (begin</span>
          <span class=pc8 title="line 589 char 3 count 1">(initialize-random-seed-once)</span>
          <span class=pc8 title="line 589 char 3 count 1">(random 1.0))]</span>
    <span class=pc8 title="line 589 char 3 count 1">;; single argument k, pick an integral value from [0, k)</span>
    <span class=pc8 title="line 589 char 3 count 1">[(k)</span>
      <span class=pc8 title="line 589 char 3 count 1">(begin</span>
        <span class=pc8 title="line 589 char 3 count 1">(initialize-random-seed-once)</span>
        <span class=pc8 title="line 589 char 3 count 1">(if (&gt; k 0)</span>
              <span class=pc8 title="line 589 char 3 count 1">(random k)</span>
              <span class=pc8 title="line 589 char 3 count 1">(assertion-violationf 'blodwen-random "invalid range argument ~a" k)))])</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">;; For finalisers</span>

<span class=pc8 title="line 16 char 1 count 1">(define blodwen-finaliser </span><span class=pc8 title="line 604 char 27 count 1">(</span><span class=pc8 title="line 604 char 28 count 1">make-guardian</span><span class=pc8 title="line 604 char 27 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 605 char 1 count 1">(define (blodwen-register-object obj proc)</span>
  <span class=pc8 title="line 605 char 1 count 1">(let [(x (cons obj proc))]</span>
       <span class=pc8 title="line 605 char 1 count 1">(blodwen-finaliser x)</span>
       <span class=pc8 title="line 605 char 1 count 1">x))</span>
<span class=pc8 title="line 16 char 1 count 1">(define blodwen-run-finalisers</span>
  <span class=pc8 title="line 610 char 3 count 1">(lambda ()</span>
    <span class=pc8 title="line 611 char 5 count 1">(let run ()</span>
      <span class=pc8 title="line 612 char 7 count 1">(let ([x </span><span class=pc8 title="line 612 char 16 count 1">(</span><span class=pc8 title="line 612 char 17 count 1">blodwen-finaliser</span><span class=pc8 title="line 612 char 16 count 1">)</span><span class=pc8 title="line 612 char 7 count 1">])</span>
        <span class=pc8 title="line 613 char 9 count 1">(when </span><span class=pc8 title="line 613 char 15 count 1">x</span>
          <span class=pc1 title="line 614 char 11 count 0">(</span><span class=pc1 title="line 614 char 12 count 0">(</span><span class=pc1 title="line 614 char 13 count 0">(</span><span class=pc1 title="line 614 char 14 count 0">cdr</span><span class=pc1 title="line 614 char 13 count 0"> </span><span class=pc1 title="line 614 char 18 count 0">x</span><span class=pc1 title="line 614 char 13 count 0">)</span><span class=pc1 title="line 614 char 12 count 0"> </span><span class=pc1 title="line 614 char 21 count 0">(</span><span class=pc1 title="line 614 char 22 count 0">car</span><span class=pc1 title="line 614 char 21 count 0"> </span><span class=pc1 title="line 614 char 26 count 0">x</span><span class=pc1 title="line 614 char 21 count 0">)</span><span class=pc1 title="line 614 char 12 count 0">)</span><span class=pc1 title="line 614 char 11 count 0"> </span><span class=pc1 title="line 614 char 30 count 0">'erased</span><span class=pc1 title="line 614 char 11 count 0">)</span>
          <span class=pc1 title="line 615 char 11 count 0">(</span><span class=pc1 title="line 615 char 12 count 0">run</span><span class=pc1 title="line 615 char 11 count 0">)</span><span class=pc8 title="line 613 char 9 count 1">)</span><span class=pc8 title="line 612 char 7 count 1">)</span><span class=pc8 title="line 611 char 5 count 1">)</span><span class=pc8 title="line 610 char 3 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>

<span class=pc8 title="line 16 char 1 count 1">;; For creating and reading back scheme objects</span>

<span class=pc8 title="line 16 char 1 count 1">; read a scheme string and evaluate it, returning 'Just result' on success</span>
<span class=pc8 title="line 16 char 1 count 1">; TODO: catch exception!</span>
<span class=pc8 title="line 621 char 1 count 1">(define (blodwen-eval-scheme str)</span>
  <span class=pc8 title="line 621 char 1 count 1">(guard</span>
     <span class=pc8 title="line 621 char 1 count 1">(x [#t '()]) ; Nothing on failure</span>
     <span class=pc8 title="line 621 char 1 count 1">(box (eval (read (open-input-string str)))))</span>
  <span class=pc8 title="line 621 char 1 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">; box == Just</span>

<span class=pc8 title="line 627 char 1 count 1">(define (blodwen-eval-okay obj)</span>
  <span class=pc8 title="line 627 char 1 count 1">(if (null? obj)</span>
      <span class=pc8 title="line 627 char 1 count 1">0</span>
      <span class=pc8 title="line 627 char 1 count 1">1))</span>

<span class=pc8 title="line 632 char 1 count 1">(define (blodwen-get-eval-result obj)</span>
  <span class=pc8 title="line 632 char 1 count 1">(unbox obj))</span>

<span class=pc8 title="line 635 char 1 count 1">(define (blodwen-debug-scheme obj)</span>
  <span class=pc8 title="line 635 char 1 count 1">(display obj) (newline))</span>

<span class=pc8 title="line 638 char 1 count 1">(define (blodwen-is-number obj)</span>
  <span class=pc8 title="line 638 char 1 count 1">(if (number? obj) 1 0))</span>

<span class=pc8 title="line 641 char 1 count 1">(define (blodwen-is-integer obj)</span>
  <span class=pc8 title="line 641 char 1 count 1">(if (and (number? obj) (exact? obj)) 1 0))</span>

<span class=pc8 title="line 644 char 1 count 1">(define (blodwen-is-float obj)</span>
  <span class=pc8 title="line 644 char 1 count 1">(if (flonum? obj) 1 0))</span>

<span class=pc8 title="line 647 char 1 count 1">(define (blodwen-is-char obj)</span>
  <span class=pc8 title="line 647 char 1 count 1">(if (char? obj) 1 0))</span>

<span class=pc8 title="line 650 char 1 count 1">(define (blodwen-is-string obj)</span>
  <span class=pc8 title="line 650 char 1 count 1">(if (string? obj) 1 0))</span>

<span class=pc8 title="line 653 char 1 count 1">(define (blodwen-is-procedure obj)</span>
  <span class=pc8 title="line 653 char 1 count 1">(if (procedure? obj) 1 0))</span>

<span class=pc8 title="line 656 char 1 count 1">(define (blodwen-is-symbol obj)</span>
  <span class=pc8 title="line 656 char 1 count 1">(if (symbol? obj) 1 0))</span>

<span class=pc8 title="line 659 char 1 count 1">(define (blodwen-is-vector obj)</span>
  <span class=pc8 title="line 659 char 1 count 1">(if (vector? obj) 1 0))</span>

<span class=pc8 title="line 662 char 1 count 1">(define (blodwen-is-nil obj)</span>
  <span class=pc8 title="line 662 char 1 count 1">(if (null? obj) 1 0))</span>

<span class=pc8 title="line 665 char 1 count 1">(define (blodwen-is-pair obj)</span>
  <span class=pc8 title="line 665 char 1 count 1">(if (pair? obj) 1 0))</span>

<span class=pc8 title="line 668 char 1 count 1">(define (blodwen-is-box obj)</span>
  <span class=pc8 title="line 668 char 1 count 1">(if (box? obj) 1 0))</span>

<span class=pc8 title="line 671 char 1 count 1">(define (blodwen-make-symbol str)</span>
  <span class=pc8 title="line 671 char 1 count 1">(string-&gt;symbol str))</span>

<span class=pc8 title="line 16 char 1 count 1">; The below rely on checking that the objects are the right type first.</span>

<span class=pc8 title="line 676 char 1 count 1">(define (blodwen-vector-ref obj i)</span>
  <span class=pc8 title="line 676 char 1 count 1">(vector-ref obj i))</span>

<span class=pc8 title="line 679 char 1 count 1">(define (blodwen-vector-length obj)</span>
  <span class=pc8 title="line 679 char 1 count 1">(vector-length obj))</span>

<span class=pc8 title="line 682 char 1 count 1">(define (blodwen-vector-list obj)</span>
  <span class=pc8 title="line 682 char 1 count 1">(vector-&gt;list obj))</span>

<span class=pc8 title="line 685 char 1 count 1">(define (blodwen-unbox obj)</span>
  <span class=pc8 title="line 685 char 1 count 1">(unbox obj))</span>

<span class=pc8 title="line 688 char 1 count 1">(define (blodwen-apply obj arg)</span>
  <span class=pc8 title="line 688 char 1 count 1">(obj arg))</span>

<span class=pc8 title="line 691 char 1 count 1">(define (blodwen-force obj)</span>
  <span class=pc8 title="line 691 char 1 count 1">(obj))</span>

<span class=pc8 title="line 694 char 1 count 1">(define (blodwen-read-symbol sym)</span>
  <span class=pc8 title="line 694 char 1 count 1">(symbol-&gt;string sym))</span>

<span class=pc8 title="line 697 char 1 count 1">(define (blodwen-id x) x)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45IO-prim__putStr </span><span class=pc8 title="line 698 char 36 count 1">(lambda (farg-0 farg-1) </span><span class=pc9 title="line 698 char 60 count 3">(</span><span class=pc9 title="line 698 char 61 count 3">(foreign-procedure </span><span class=pc9 title="line 698 char 80 count 3">"idris2_putStr"</span><span class=pc9 title="line 698 char 61 count 3"> (string) void)</span><span class=pc9 title="line 698 char 60 count 3"> </span><span class=pc9 title="line 698 char 111 count 3">farg-0</span><span class=pc9 title="line 698 char 60 count 3">)</span><span class=pc8 title="line 698 char 36 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define u--prim__sub_Integer </span><span class=pc8 title="line 699 char 30 count 1">(lambda (arg-0 arg-1) (- arg-0 arg-1))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define Sample-multiply </span><span class=pc8 title="line 700 char 25 count 1">(lambda (arg-0 arg-1) </span><span class=pc8 title="line 700 char 47 count 1">(</span><span class=pc8 title="line 700 char 48 count 1">bs*</span><span class=pc8 title="line 700 char 47 count 1"> </span><span class=pc8 title="line 700 char 52 count 1">arg-0</span><span class=pc8 title="line 700 char 47 count 1"> </span><span class=pc8 title="line 700 char 58 count 1">arg-1</span><span class=pc8 title="line 700 char 47 count 1"> </span><span class=pc8 title="line 700 char 64 count 1">63</span><span class=pc8 title="line 700 char 47 count 1">)</span><span class=pc8 title="line 700 char 25 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define Sample-add </span><span class=pc8 title="line 701 char 20 count 1">(lambda (arg-0 arg-1) </span><span class=pc8 title="line 701 char 42 count 1">(</span><span class=pc8 title="line 701 char 43 count 1">bs+</span><span class=pc8 title="line 701 char 42 count 1"> </span><span class=pc8 title="line 701 char 47 count 1">arg-0</span><span class=pc8 title="line 701 char 42 count 1"> </span><span class=pc8 title="line 701 char 53 count 1">arg-1</span><span class=pc8 title="line 701 char 42 count 1"> </span><span class=pc8 title="line 701 char 59 count 1">63</span><span class=pc8 title="line 701 char 42 count 1">)</span><span class=pc8 title="line 701 char 20 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define Sample-factorial </span><span class=pc8 title="line 702 char 26 count 1">(lambda (arg-0) </span><span class=pc11 title="line 702 char 42 count 6">(cond (</span><span class=pc11 title="line 702 char 49 count 6">(</span><span class=pc11 title="line 702 char 50 count 6">equal?</span><span class=pc11 title="line 702 char 49 count 6"> </span><span class=pc11 title="line 702 char 57 count 6">arg-0</span><span class=pc11 title="line 702 char 49 count 6"> </span><span class=pc11 title="line 702 char 63 count 6">0</span><span class=pc11 title="line 702 char 49 count 6">)</span><span class=pc11 title="line 702 char 42 count 6"> </span><span class=pc8 title="line 702 char 66 count 1">1</span><span class=pc11 title="line 702 char 42 count 6">)(else </span><span class=pc10 title="line 702 char 74 count 5">(</span><span class=pc10 title="line 702 char 75 count 5">bs*</span><span class=pc10 title="line 702 char 74 count 5"> </span><span class=pc10 title="line 702 char 79 count 5">arg-0</span><span class=pc10 title="line 702 char 74 count 5"> </span><span class=pc10 title="line 702 char 85 count 5">(</span><span class=pc10 title="line 702 char 86 count 5">Sample-factorial</span><span class=pc10 title="line 702 char 85 count 5"> </span><span class=pc10 title="line 702 char 103 count 5">(</span><span class=pc10 title="line 702 char 104 count 5">bs-</span><span class=pc10 title="line 702 char 103 count 5"> </span><span class=pc10 title="line 702 char 108 count 5">arg-0</span><span class=pc10 title="line 702 char 103 count 5"> </span><span class=pc10 title="line 702 char 114 count 5">1</span><span class=pc10 title="line 702 char 103 count 5"> </span><span class=pc10 title="line 702 char 116 count 5">63</span><span class=pc10 title="line 702 char 103 count 5">)</span><span class=pc10 title="line 702 char 85 count 5">)</span><span class=pc10 title="line 702 char 74 count 5"> </span><span class=pc10 title="line 702 char 121 count 5">63</span><span class=pc10 title="line 702 char 74 count 5">)</span><span class=pc11 title="line 702 char 42 count 6">))</span><span class=pc8 title="line 702 char 26 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Show-firstCharIs </span><span class=pc8 title="line 703 char 37 count 1">(lambda (arg-0 arg-1) </span><span class=pc1 title="line 703 char 59 count 0">(cond (</span><span class=pc1 title="line 703 char 66 count 0">(</span><span class=pc1 title="line 703 char 67 count 0">equal?</span><span class=pc1 title="line 703 char 66 count 0"> </span><span class=pc1 title="line 703 char 74 count 0">arg-1</span><span class=pc1 title="line 703 char 66 count 0"> </span><span class=pc1 title="line 703 char 80 count 0">""</span><span class=pc1 title="line 703 char 66 count 0">)</span><span class=pc1 title="line 703 char 59 count 0"> </span><span class=pc1 title="line 703 char 84 count 0">0</span><span class=pc1 title="line 703 char 59 count 0">)(else </span><span class=pc1 title="line 703 char 92 count 0">(</span><span class=pc1 title="line 703 char 93 count 0">arg-0</span><span class=pc1 title="line 703 char 92 count 0"> </span><span class=pc1 title="line 703 char 99 count 0">(</span><span class=pc1 title="line 703 char 100 count 0">string-ref</span><span class=pc1 title="line 703 char 99 count 0"> </span><span class=pc1 title="line 703 char 111 count 0">arg-1</span><span class=pc1 title="line 703 char 99 count 0"> </span><span class=pc1 title="line 703 char 117 count 0">0</span><span class=pc1 title="line 703 char 99 count 0">)</span><span class=pc1 title="line 703 char 92 count 0">)</span><span class=pc1 title="line 703 char 59 count 0">))</span><span class=pc8 title="line 703 char 37 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Show-showParens </span><span class=pc8 title="line 704 char 36 count 1">(lambda (arg-0 arg-1) </span><span class=pc9 title="line 704 char 58 count 3">(cond (</span><span class=pc9 title="line 704 char 65 count 3">(</span><span class=pc9 title="line 704 char 66 count 3">equal?</span><span class=pc9 title="line 704 char 65 count 3"> </span><span class=pc9 title="line 704 char 73 count 3">arg-0</span><span class=pc9 title="line 704 char 65 count 3"> </span><span class=pc9 title="line 704 char 79 count 3">0</span><span class=pc9 title="line 704 char 65 count 3">)</span><span class=pc9 title="line 704 char 58 count 3"> </span><span class=pc9 title="line 704 char 82 count 3">arg-1</span><span class=pc9 title="line 704 char 58 count 3">) (else </span><span class=pc1 title="line 704 char 95 count 0">(</span><span class=pc1 title="line 704 char 96 count 0">string-append</span><span class=pc1 title="line 704 char 95 count 0"> </span><span class=pc1 title="line 704 char 110 count 0">"("</span><span class=pc1 title="line 704 char 95 count 0"> </span><span class=pc1 title="line 704 char 114 count 0">(</span><span class=pc1 title="line 704 char 115 count 0">string-append</span><span class=pc1 title="line 704 char 114 count 0"> </span><span class=pc1 title="line 704 char 129 count 0">arg-1</span><span class=pc1 title="line 704 char 114 count 0"> </span><span class=pc1 title="line 704 char 135 count 0">")"</span><span class=pc1 title="line 704 char 114 count 0">)</span><span class=pc1 title="line 704 char 95 count 0">)</span><span class=pc9 title="line 704 char 58 count 3">))</span><span class=pc8 title="line 704 char 36 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45EqOrd-u--C-61C-61_Eq_Char </span><span class=pc8 title="line 705 char 46 count 1">(lambda (arg-0 arg-1) </span><span class=pc1 title="line 705 char 68 count 0">(let ((sc0 </span><span class=pc1 title="line 705 char 79 count 0">(or </span><span class=pc1 title="line 705 char 83 count 0">(and </span><span class=pc1 title="line 705 char 88 count 0">(</span><span class=pc1 title="line 705 char 89 count 0">char=?</span><span class=pc1 title="line 705 char 88 count 0"> </span><span class=pc1 title="line 705 char 96 count 0">arg-0</span><span class=pc1 title="line 705 char 88 count 0"> </span><span class=pc1 title="line 705 char 102 count 0">arg-1</span><span class=pc1 title="line 705 char 88 count 0">)</span><span class=pc1 title="line 705 char 83 count 0"> </span><span class=pc1 title="line 705 char 109 count 0">1</span><span class=pc1 title="line 705 char 83 count 0">)</span><span class=pc1 title="line 705 char 79 count 0"> </span><span class=pc1 title="line 705 char 112 count 0">0</span><span class=pc1 title="line 705 char 79 count 0">)</span><span class=pc1 title="line 705 char 68 count 0">)) </span><span class=pc1 title="line 705 char 117 count 0">(cond (</span><span class=pc1 title="line 705 char 124 count 0">(</span><span class=pc1 title="line 705 char 125 count 0">equal?</span><span class=pc1 title="line 705 char 124 count 0"> </span><span class=pc1 title="line 705 char 132 count 0">sc0</span><span class=pc1 title="line 705 char 124 count 0"> </span><span class=pc1 title="line 705 char 136 count 0">0</span><span class=pc1 title="line 705 char 124 count 0">)</span><span class=pc1 title="line 705 char 117 count 0"> </span><span class=pc1 title="line 705 char 139 count 0">0</span><span class=pc1 title="line 705 char 117 count 0">)(else </span><span class=pc1 title="line 705 char 147 count 0">1</span><span class=pc1 title="line 705 char 117 count 0">))</span><span class=pc1 title="line 705 char 68 count 0">)</span><span class=pc8 title="line 705 char 46 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering </span><span class=pc8 title="line 706 char 50 count 1">(lambda (arg-0 arg-1) </span><span class=pc9 title="line 706 char 72 count 3">(cond (</span><span class=pc9 title="line 706 char 79 count 3">(</span><span class=pc9 title="line 706 char 80 count 3">equal?</span><span class=pc9 title="line 706 char 79 count 3"> </span><span class=pc9 title="line 706 char 87 count 3">arg-0</span><span class=pc9 title="line 706 char 79 count 3"> </span><span class=pc9 title="line 706 char 93 count 3">0</span><span class=pc9 title="line 706 char 79 count 3">)</span><span class=pc9 title="line 706 char 72 count 3"> </span><span class=pc9 title="line 706 char 96 count 3">(cond (</span><span class=pc9 title="line 706 char 103 count 3">(</span><span class=pc9 title="line 706 char 104 count 3">equal?</span><span class=pc9 title="line 706 char 103 count 3"> </span><span class=pc9 title="line 706 char 111 count 3">arg-1</span><span class=pc9 title="line 706 char 103 count 3"> </span><span class=pc9 title="line 706 char 117 count 3">0</span><span class=pc9 title="line 706 char 103 count 3">)</span><span class=pc9 title="line 706 char 96 count 3"> </span><span class=pc9 title="line 706 char 120 count 3">1</span><span class=pc9 title="line 706 char 96 count 3">)(else 0))</span><span class=pc9 title="line 706 char 72 count 3">) (</span><span class=pc1 title="line 706 char 134 count 0">(</span><span class=pc1 title="line 706 char 135 count 0">equal?</span><span class=pc1 title="line 706 char 134 count 0"> </span><span class=pc1 title="line 706 char 142 count 0">arg-0</span><span class=pc1 title="line 706 char 134 count 0"> </span><span class=pc1 title="line 706 char 148 count 0">1</span><span class=pc1 title="line 706 char 134 count 0">)</span><span class=pc9 title="line 706 char 72 count 3"> </span><span class=pc1 title="line 706 char 151 count 0">(cond (</span><span class=pc1 title="line 706 char 158 count 0">(</span><span class=pc1 title="line 706 char 159 count 0">equal?</span><span class=pc1 title="line 706 char 158 count 0"> </span><span class=pc1 title="line 706 char 166 count 0">arg-1</span><span class=pc1 title="line 706 char 158 count 0"> </span><span class=pc1 title="line 706 char 172 count 0">1</span><span class=pc1 title="line 706 char 158 count 0">)</span><span class=pc1 title="line 706 char 151 count 0"> 1)(else </span><span class=pc1 title="line 706 char 183 count 0">0</span><span class=pc1 title="line 706 char 151 count 0">))</span><span class=pc9 title="line 706 char 72 count 3">) (</span><span class=pc1 title="line 706 char 189 count 0">(</span><span class=pc1 title="line 706 char 190 count 0">equal?</span><span class=pc1 title="line 706 char 189 count 0"> </span><span class=pc1 title="line 706 char 197 count 0">arg-0</span><span class=pc1 title="line 706 char 189 count 0"> </span><span class=pc1 title="line 706 char 203 count 0">2</span><span class=pc1 title="line 706 char 189 count 0">)</span><span class=pc9 title="line 706 char 72 count 3"> </span><span class=pc1 title="line 706 char 206 count 0">(cond (</span><span class=pc1 title="line 706 char 213 count 0">(</span><span class=pc1 title="line 706 char 214 count 0">equal?</span><span class=pc1 title="line 706 char 213 count 0"> </span><span class=pc1 title="line 706 char 221 count 0">arg-1</span><span class=pc1 title="line 706 char 213 count 0"> </span><span class=pc1 title="line 706 char 227 count 0">2</span><span class=pc1 title="line 706 char 213 count 0">)</span><span class=pc1 title="line 706 char 206 count 0"> 1)(else </span><span class=pc1 title="line 706 char 238 count 0">0</span><span class=pc1 title="line 706 char 206 count 0">))</span><span class=pc9 title="line 706 char 72 count 3">)(else </span><span class=pc1 title="line 706 char 248 count 0">0</span><span class=pc9 title="line 706 char 72 count 3">))</span><span class=pc8 title="line 706 char 50 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45EqOrd-u--C-47C-61_Eq_Ordering </span><span class=pc8 title="line 707 char 50 count 1">(lambda (arg-0 arg-1) </span><span class=pc9 title="line 707 char 72 count 3">(let ((sc0 </span><span class=pc9 title="line 707 char 83 count 3">(</span><span class=pc9 title="line 707 char 84 count 3">PreludeC-45EqOrd-u--C-61C-61_Eq_Ordering</span><span class=pc9 title="line 707 char 83 count 3"> </span><span class=pc9 title="line 707 char 125 count 3">arg-0</span><span class=pc9 title="line 707 char 83 count 3"> </span><span class=pc9 title="line 707 char 131 count 3">arg-1</span><span class=pc9 title="line 707 char 83 count 3">)</span><span class=pc9 title="line 707 char 72 count 3">)) </span><span class=pc9 title="line 707 char 140 count 3">(cond (</span><span class=pc9 title="line 707 char 147 count 3">(</span><span class=pc9 title="line 707 char 148 count 3">equal?</span><span class=pc9 title="line 707 char 147 count 3"> </span><span class=pc9 title="line 707 char 155 count 3">sc0</span><span class=pc9 title="line 707 char 147 count 3"> </span><span class=pc9 title="line 707 char 159 count 3">1</span><span class=pc9 title="line 707 char 147 count 3">)</span><span class=pc9 title="line 707 char 140 count 3"> </span><span class=pc9 title="line 707 char 162 count 3">0</span><span class=pc9 title="line 707 char 140 count 3">) (else </span><span class=pc1 title="line 707 char 171 count 0">1</span><span class=pc9 title="line 707 char 140 count 3">))</span><span class=pc9 title="line 707 char 72 count 3">)</span><span class=pc8 title="line 707 char 50 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Show-precCon </span><span class=pc8 title="line 708 char 33 count 1">(lambda (arg-0) </span><span class=pc11 title="line 708 char 49 count 6">(case </span><span class=pc11 title="line 708 char 55 count 6">(</span><span class=pc11 title="line 708 char 56 count 6">vector-ref</span><span class=pc11 title="line 708 char 55 count 6"> </span><span class=pc11 title="line 708 char 67 count 6">arg-0</span><span class=pc11 title="line 708 char 55 count 6"> </span><span class=pc11 title="line 708 char 73 count 6">0</span><span class=pc11 title="line 708 char 55 count 6">)</span><span class=pc11 title="line 708 char 49 count 6"> ((0) </span><span class=pc9 title="line 708 char 81 count 3">0</span><span class=pc11 title="line 708 char 49 count 6">) ((1) </span><span class=pc1 title="line 708 char 89 count 0">1</span><span class=pc11 title="line 708 char 49 count 6">) ((2) </span><span class=pc1 title="line 708 char 97 count 0">2</span><span class=pc11 title="line 708 char 49 count 6">) ((3) </span><span class=pc1 title="line 708 char 105 count 0">3</span><span class=pc11 title="line 708 char 49 count 6">) ((4) </span><span class=pc1 title="line 708 char 113 count 0">4</span><span class=pc11 title="line 708 char 49 count 6">) ((5) </span><span class=pc9 title="line 708 char 121 count 3">5</span><span class=pc11 title="line 708 char 49 count 6">) (else </span><span class=pc1 title="line 708 char 130 count 0">6</span><span class=pc11 title="line 708 char 49 count 6">))</span><span class=pc8 title="line 708 char 33 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45EqOrd-u--C-60_Ord_Integer </span><span class=pc8 title="line 709 char 46 count 1">(lambda (arg-0 arg-1) </span><span class=pc9 title="line 709 char 68 count 3">(let ((sc0 </span><span class=pc9 title="line 709 char 79 count 3">(or </span><span class=pc9 title="line 709 char 83 count 3">(and </span><span class=pc9 title="line 709 char 88 count 3">(</span><span class=pc9 title="line 709 char 89 count 3">&lt;</span><span class=pc9 title="line 709 char 88 count 3"> </span><span class=pc9 title="line 709 char 91 count 3">arg-0</span><span class=pc9 title="line 709 char 88 count 3"> </span><span class=pc9 title="line 709 char 97 count 3">arg-1</span><span class=pc9 title="line 709 char 88 count 3">)</span><span class=pc9 title="line 709 char 83 count 3"> </span><span class=pc9 title="line 709 char 104 count 3">1</span><span class=pc9 title="line 709 char 83 count 3">)</span><span class=pc9 title="line 709 char 79 count 3"> </span><span class=pc1 title="line 709 char 107 count 0">0</span><span class=pc9 title="line 709 char 79 count 3">)</span><span class=pc9 title="line 709 char 68 count 3">)) </span><span class=pc9 title="line 709 char 112 count 3">(cond (</span><span class=pc9 title="line 709 char 119 count 3">(</span><span class=pc9 title="line 709 char 120 count 3">equal?</span><span class=pc9 title="line 709 char 119 count 3"> </span><span class=pc9 title="line 709 char 127 count 3">sc0</span><span class=pc9 title="line 709 char 119 count 3"> </span><span class=pc9 title="line 709 char 131 count 3">0</span><span class=pc9 title="line 709 char 119 count 3">)</span><span class=pc9 title="line 709 char 112 count 3"> </span><span class=pc1 title="line 709 char 134 count 0">0</span><span class=pc9 title="line 709 char 112 count 3">)(else </span><span class=pc9 title="line 709 char 142 count 3">1</span><span class=pc9 title="line 709 char 112 count 3">))</span><span class=pc9 title="line 709 char 68 count 3">)</span><span class=pc8 title="line 709 char 46 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45EqOrd-u--C-61C-61_Eq_Integer </span><span class=pc8 title="line 710 char 49 count 1">(lambda (arg-0 arg-1) </span><span class=pc1 title="line 710 char 71 count 0">(let ((sc0 </span><span class=pc1 title="line 710 char 82 count 0">(or </span><span class=pc1 title="line 710 char 86 count 0">(and </span><span class=pc1 title="line 710 char 91 count 0">(</span><span class=pc1 title="line 710 char 92 count 0">=</span><span class=pc1 title="line 710 char 91 count 0"> </span><span class=pc1 title="line 710 char 94 count 0">arg-0</span><span class=pc1 title="line 710 char 91 count 0"> </span><span class=pc1 title="line 710 char 100 count 0">arg-1</span><span class=pc1 title="line 710 char 91 count 0">)</span><span class=pc1 title="line 710 char 86 count 0"> </span><span class=pc1 title="line 710 char 107 count 0">1</span><span class=pc1 title="line 710 char 86 count 0">)</span><span class=pc1 title="line 710 char 82 count 0"> </span><span class=pc1 title="line 710 char 110 count 0">0</span><span class=pc1 title="line 710 char 82 count 0">)</span><span class=pc1 title="line 710 char 71 count 0">)) </span><span class=pc1 title="line 710 char 115 count 0">(cond (</span><span class=pc1 title="line 710 char 122 count 0">(</span><span class=pc1 title="line 710 char 123 count 0">equal?</span><span class=pc1 title="line 710 char 122 count 0"> </span><span class=pc1 title="line 710 char 130 count 0">sc0</span><span class=pc1 title="line 710 char 122 count 0"> </span><span class=pc1 title="line 710 char 134 count 0">0</span><span class=pc1 title="line 710 char 122 count 0">)</span><span class=pc1 title="line 710 char 115 count 0"> </span><span class=pc1 title="line 710 char 137 count 0">0</span><span class=pc1 title="line 710 char 115 count 0">)(else </span><span class=pc1 title="line 710 char 145 count 0">1</span><span class=pc1 title="line 710 char 115 count 0">))</span><span class=pc1 title="line 710 char 71 count 0">)</span><span class=pc8 title="line 710 char 49 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45EqOrd-u--compare_Ord_Integer </span><span class=pc8 title="line 711 char 49 count 1">(lambda (arg-0 arg-1) </span><span class=pc9 title="line 711 char 71 count 3">(let ((sc0 </span><span class=pc9 title="line 711 char 82 count 3">(</span><span class=pc9 title="line 711 char 83 count 3">PreludeC-45EqOrd-u--C-60_Ord_Integer</span><span class=pc9 title="line 711 char 82 count 3"> </span><span class=pc9 title="line 711 char 120 count 3">arg-0</span><span class=pc9 title="line 711 char 82 count 3"> </span><span class=pc9 title="line 711 char 126 count 3">arg-1</span><span class=pc9 title="line 711 char 82 count 3">)</span><span class=pc9 title="line 711 char 71 count 3">)) </span><span class=pc9 title="line 711 char 135 count 3">(cond (</span><span class=pc9 title="line 711 char 142 count 3">(</span><span class=pc9 title="line 711 char 143 count 3">equal?</span><span class=pc9 title="line 711 char 142 count 3"> </span><span class=pc9 title="line 711 char 150 count 3">sc0</span><span class=pc9 title="line 711 char 142 count 3"> </span><span class=pc9 title="line 711 char 154 count 3">1</span><span class=pc9 title="line 711 char 142 count 3">)</span><span class=pc9 title="line 711 char 135 count 3"> </span><span class=pc9 title="line 711 char 157 count 3">0</span><span class=pc9 title="line 711 char 135 count 3">) (else </span><span class=pc1 title="line 711 char 166 count 0">(let ((sc1 </span><span class=pc1 title="line 711 char 177 count 0">(</span><span class=pc1 title="line 711 char 178 count 0">PreludeC-45EqOrd-u--C-61C-61_Eq_Integer</span><span class=pc1 title="line 711 char 177 count 0"> </span><span class=pc1 title="line 711 char 218 count 0">arg-0</span><span class=pc1 title="line 711 char 177 count 0"> </span><span class=pc1 title="line 711 char 224 count 0">arg-1</span><span class=pc1 title="line 711 char 177 count 0">)</span><span class=pc1 title="line 711 char 166 count 0">)) </span><span class=pc1 title="line 711 char 233 count 0">(cond (</span><span class=pc1 title="line 711 char 240 count 0">(</span><span class=pc1 title="line 711 char 241 count 0">equal?</span><span class=pc1 title="line 711 char 240 count 0"> </span><span class=pc1 title="line 711 char 248 count 0">sc1</span><span class=pc1 title="line 711 char 240 count 0"> </span><span class=pc1 title="line 711 char 252 count 0">1</span><span class=pc1 title="line 711 char 240 count 0">)</span><span class=pc1 title="line 711 char 233 count 0"> </span><span class=pc1 title="line 711 char 255 count 0">1</span><span class=pc1 title="line 711 char 233 count 0">) (else </span><span class=pc1 title="line 711 char 264 count 0">2</span><span class=pc1 title="line 711 char 233 count 0">))</span><span class=pc1 title="line 711 char 166 count 0">)</span><span class=pc9 title="line 711 char 135 count 3">))</span><span class=pc9 title="line 711 char 71 count 3">)</span><span class=pc8 title="line 711 char 49 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Show-u--compare_Ord_Prec </span><span class=pc8 title="line 712 char 45 count 1">(lambda (arg-0 arg-1) </span><span class=pc9 title="line 712 char 67 count 3">(case </span><span class=pc9 title="line 712 char 73 count 3">(</span><span class=pc9 title="line 712 char 74 count 3">vector-ref</span><span class=pc9 title="line 712 char 73 count 3"> </span><span class=pc9 title="line 712 char 85 count 3">arg-0</span><span class=pc9 title="line 712 char 73 count 3"> </span><span class=pc9 title="line 712 char 91 count 3">0</span><span class=pc9 title="line 712 char 73 count 3">)</span><span class=pc9 title="line 712 char 67 count 3"> ((4) </span><span class=pc1 title="line 712 char 99 count 0">(let ((e-0 </span><span class=pc1 title="line 712 char 110 count 0">(</span><span class=pc1 title="line 712 char 111 count 0">vector-ref</span><span class=pc1 title="line 712 char 110 count 0"> </span><span class=pc1 title="line 712 char 122 count 0">arg-0</span><span class=pc1 title="line 712 char 110 count 0"> </span><span class=pc1 title="line 712 char 128 count 0">1</span><span class=pc1 title="line 712 char 110 count 0">)</span><span class=pc1 title="line 712 char 99 count 0">)) </span><span class=pc1 title="line 712 char 133 count 0">(case </span><span class=pc1 title="line 712 char 139 count 0">(</span><span class=pc1 title="line 712 char 140 count 0">vector-ref</span><span class=pc1 title="line 712 char 139 count 0"> </span><span class=pc1 title="line 712 char 151 count 0">arg-1</span><span class=pc1 title="line 712 char 139 count 0"> </span><span class=pc1 title="line 712 char 157 count 0">0</span><span class=pc1 title="line 712 char 139 count 0">)</span><span class=pc1 title="line 712 char 133 count 0"> ((4) </span><span class=pc1 title="line 712 char 165 count 0">(let ((e-1 </span><span class=pc1 title="line 712 char 176 count 0">(</span><span class=pc1 title="line 712 char 177 count 0">vector-ref</span><span class=pc1 title="line 712 char 176 count 0"> </span><span class=pc1 title="line 712 char 188 count 0">arg-1</span><span class=pc1 title="line 712 char 176 count 0"> </span><span class=pc1 title="line 712 char 194 count 0">1</span><span class=pc1 title="line 712 char 176 count 0">)</span><span class=pc1 title="line 712 char 165 count 0">)) </span><span class=pc1 title="line 712 char 199 count 0">(</span><span class=pc1 title="line 712 char 200 count 0">PreludeC-45EqOrd-u--compare_Ord_Integer</span><span class=pc1 title="line 712 char 199 count 0"> </span><span class=pc1 title="line 712 char 240 count 0">e-0</span><span class=pc1 title="line 712 char 199 count 0"> </span><span class=pc1 title="line 712 char 244 count 0">e-1</span><span class=pc1 title="line 712 char 199 count 0">)</span><span class=pc1 title="line 712 char 165 count 0">)</span><span class=pc1 title="line 712 char 133 count 0">)(else </span><span class=pc1 title="line 712 char 256 count 0">(</span><span class=pc1 title="line 712 char 257 count 0">PreludeC-45EqOrd-u--compare_Ord_Integer</span><span class=pc1 title="line 712 char 256 count 0"> </span><span class=pc1 title="line 712 char 297 count 0">(</span><span class=pc1 title="line 712 char 298 count 0">PreludeC-45Show-precCon</span><span class=pc1 title="line 712 char 297 count 0"> </span><span class=pc1 title="line 712 char 322 count 0">arg-0</span><span class=pc1 title="line 712 char 297 count 0">)</span><span class=pc1 title="line 712 char 256 count 0"> </span><span class=pc1 title="line 712 char 329 count 0">(</span><span class=pc1 title="line 712 char 330 count 0">PreludeC-45Show-precCon</span><span class=pc1 title="line 712 char 329 count 0"> </span><span class=pc1 title="line 712 char 354 count 0">arg-1</span><span class=pc1 title="line 712 char 329 count 0">)</span><span class=pc1 title="line 712 char 256 count 0">)</span><span class=pc1 title="line 712 char 133 count 0">))</span><span class=pc1 title="line 712 char 99 count 0">)</span><span class=pc9 title="line 712 char 67 count 3">)(else </span><span class=pc9 title="line 712 char 371 count 3">(</span><span class=pc9 title="line 712 char 372 count 3">PreludeC-45EqOrd-u--compare_Ord_Integer</span><span class=pc9 title="line 712 char 371 count 3"> </span><span class=pc9 title="line 712 char 412 count 3">(</span><span class=pc9 title="line 712 char 413 count 3">PreludeC-45Show-precCon</span><span class=pc9 title="line 712 char 412 count 3"> </span><span class=pc9 title="line 712 char 437 count 3">arg-0</span><span class=pc9 title="line 712 char 412 count 3">)</span><span class=pc9 title="line 712 char 371 count 3"> </span><span class=pc9 title="line 712 char 444 count 3">(</span><span class=pc9 title="line 712 char 445 count 3">PreludeC-45Show-precCon</span><span class=pc9 title="line 712 char 444 count 3"> </span><span class=pc9 title="line 712 char 469 count 3">arg-1</span><span class=pc9 title="line 712 char 444 count 3">)</span><span class=pc9 title="line 712 char 371 count 3">)</span><span class=pc9 title="line 712 char 67 count 3">))</span><span class=pc8 title="line 712 char 45 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Show-u--C-62C-61_Ord_Prec </span><span class=pc8 title="line 713 char 46 count 1">(lambda (arg-0 arg-1) </span><span class=pc9 title="line 713 char 68 count 3">(</span><span class=pc9 title="line 713 char 69 count 3">PreludeC-45EqOrd-u--C-47C-61_Eq_Ordering</span><span class=pc9 title="line 713 char 68 count 3"> </span><span class=pc9 title="line 713 char 110 count 3">(</span><span class=pc9 title="line 713 char 111 count 3">PreludeC-45Show-u--compare_Ord_Prec</span><span class=pc9 title="line 713 char 110 count 3"> </span><span class=pc9 title="line 713 char 147 count 3">arg-0</span><span class=pc9 title="line 713 char 110 count 3"> </span><span class=pc9 title="line 713 char 153 count 3">arg-1</span><span class=pc9 title="line 713 char 110 count 3">)</span><span class=pc9 title="line 713 char 68 count 3"> </span><span class=pc9 title="line 713 char 160 count 3">0</span><span class=pc9 title="line 713 char 68 count 3">)</span><span class=pc8 title="line 713 char 46 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Show-primNumShow </span><span class=pc8 title="line 714 char 37 count 1">(lambda (arg-1 arg-2 arg-3) </span><span class=pc9 title="line 714 char 65 count 3">(let ((u--str </span><span class=pc9 title="line 714 char 79 count 3">(</span><span class=pc9 title="line 714 char 80 count 3">arg-1</span><span class=pc9 title="line 714 char 79 count 3"> </span><span class=pc9 title="line 714 char 86 count 3">arg-3</span><span class=pc9 title="line 714 char 79 count 3">)</span><span class=pc9 title="line 714 char 65 count 3">)) </span><span class=pc9 title="line 714 char 95 count 3">(</span><span class=pc9 title="line 714 char 96 count 3">PreludeC-45Show-showParens</span><span class=pc9 title="line 714 char 95 count 3"> </span><span class=pc9 title="line 714 char 123 count 3">(let ((sc0 </span><span class=pc9 title="line 714 char 134 count 3">(</span><span class=pc9 title="line 714 char 135 count 3">PreludeC-45Show-u--C-62C-61_Ord_Prec</span><span class=pc9 title="line 714 char 134 count 3"> </span><span class=pc9 title="line 714 char 172 count 3">arg-2</span><span class=pc9 title="line 714 char 134 count 3"> </span><span class=pc9 title="line 714 char 178 count 3">(</span><span class=pc9 title="line 714 char 179 count 3">vector</span><span class=pc9 title="line 714 char 178 count 3"> </span><span class=pc9 title="line 714 char 186 count 3">5</span><span class=pc9 title="line 714 char 178 count 3"> )</span><span class=pc9 title="line 714 char 134 count 3">)</span><span class=pc9 title="line 714 char 123 count 3">)) </span><span class=pc9 title="line 714 char 193 count 3">(cond (</span><span class=pc9 title="line 714 char 200 count 3">(</span><span class=pc9 title="line 714 char 201 count 3">equal?</span><span class=pc9 title="line 714 char 200 count 3"> </span><span class=pc9 title="line 714 char 208 count 3">sc0</span><span class=pc9 title="line 714 char 200 count 3"> </span><span class=pc9 title="line 714 char 212 count 3">1</span><span class=pc9 title="line 714 char 200 count 3">)</span><span class=pc9 title="line 714 char 193 count 3"> </span><span class=pc1 title="line 714 char 215 count 0">(</span><span class=pc1 title="line 714 char 216 count 0">PreludeC-45Show-firstCharIs</span><span class=pc1 title="line 714 char 215 count 0"> </span><span class=pc1 title="line 714 char 244 count 0">(lambda (arg-0) </span><span class=pc1 title="line 714 char 260 count 0">(</span><span class=pc1 title="line 714 char 261 count 0">PreludeC-45EqOrd-u--C-61C-61_Eq_Char</span><span class=pc1 title="line 714 char 260 count 0"> </span><span class=pc1 title="line 714 char 298 count 0">arg-0</span><span class=pc1 title="line 714 char 260 count 0"> </span><span class=pc1 title="line 714 char 304 count 0">#\-</span><span class=pc1 title="line 714 char 260 count 0">)</span><span class=pc1 title="line 714 char 244 count 0">)</span><span class=pc1 title="line 714 char 215 count 0"> </span><span class=pc1 title="line 714 char 310 count 0">u--str</span><span class=pc1 title="line 714 char 215 count 0">)</span><span class=pc9 title="line 714 char 193 count 3">) (else </span><span class=pc9 title="line 714 char 325 count 3">0</span><span class=pc9 title="line 714 char 193 count 3">))</span><span class=pc9 title="line 714 char 123 count 3">)</span><span class=pc9 title="line 714 char 95 count 3"> </span><span class=pc9 title="line 714 char 330 count 3">u--str</span><span class=pc9 title="line 714 char 95 count 3">)</span><span class=pc9 title="line 714 char 65 count 3">)</span><span class=pc8 title="line 714 char 37 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Show-u--showPrec_Show_Int </span><span class=pc8 title="line 715 char 46 count 1">(lambda (ext-0 ext-1) </span><span class=pc9 title="line 715 char 68 count 3">(</span><span class=pc9 title="line 715 char 69 count 3">PreludeC-45Show-primNumShow</span><span class=pc9 title="line 715 char 68 count 3"> </span><span class=pc9 title="line 715 char 97 count 3">(lambda (eta-0) </span><span class=pc9 title="line 715 char 113 count 3">(</span><span class=pc9 title="line 715 char 114 count 3">number-&gt;string</span><span class=pc9 title="line 715 char 113 count 3"> </span><span class=pc9 title="line 715 char 129 count 3">eta-0</span><span class=pc9 title="line 715 char 113 count 3">)</span><span class=pc9 title="line 715 char 97 count 3">)</span><span class=pc9 title="line 715 char 68 count 3"> </span><span class=pc9 title="line 715 char 137 count 3">ext-0</span><span class=pc9 title="line 715 char 68 count 3"> </span><span class=pc9 title="line 715 char 143 count 3">ext-1</span><span class=pc9 title="line 715 char 68 count 3">)</span><span class=pc8 title="line 715 char 46 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Show-u--show_Show_Int </span><span class=pc8 title="line 716 char 42 count 1">(lambda (arg-0) </span><span class=pc9 title="line 716 char 58 count 3">(</span><span class=pc9 title="line 716 char 59 count 3">PreludeC-45Show-u--showPrec_Show_Int</span><span class=pc9 title="line 716 char 58 count 3"> </span><span class=pc9 title="line 716 char 96 count 3">(</span><span class=pc9 title="line 716 char 97 count 3">vector</span><span class=pc9 title="line 716 char 96 count 3"> </span><span class=pc9 title="line 716 char 104 count 3">0</span><span class=pc9 title="line 716 char 96 count 3"> )</span><span class=pc9 title="line 716 char 58 count 3"> </span><span class=pc9 title="line 716 char 108 count 3">arg-0</span><span class=pc9 title="line 716 char 58 count 3">)</span><span class=pc8 title="line 716 char 42 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define Sample-main </span><span class=pc8 title="line 717 char 21 count 1">(lambda (ext-0) </span><span class=pc8 title="line 717 char 37 count 1">(let ((act-1 </span><span class=pc8 title="line 717 char 50 count 1">(</span><span class=pc8 title="line 717 char 51 count 1">PreludeC-45IO-prim__putStr</span><span class=pc8 title="line 717 char 50 count 1"> </span><span class=pc8 title="line 717 char 78 count 1">(</span><span class=pc8 title="line 717 char 79 count 1">string-append</span><span class=pc8 title="line 717 char 78 count 1"> </span><span class=pc8 title="line 717 char 93 count 1">(</span><span class=pc8 title="line 717 char 94 count 1">string-append</span><span class=pc8 title="line 717 char 93 count 1"> </span><span class=pc8 title="line 717 char 108 count 1">"add 2 3 = "</span><span class=pc8 title="line 717 char 93 count 1"> </span><span class=pc8 title="line 717 char 121 count 1">(</span><span class=pc8 title="line 717 char 122 count 1">PreludeC-45Show-u--show_Show_Int</span><span class=pc8 title="line 717 char 121 count 1"> </span><span class=pc8 title="line 717 char 155 count 1">(</span><span class=pc8 title="line 717 char 156 count 1">Sample-add</span><span class=pc8 title="line 717 char 155 count 1"> </span><span class=pc8 title="line 717 char 167 count 1">2</span><span class=pc8 title="line 717 char 155 count 1"> </span><span class=pc8 title="line 717 char 169 count 1">3</span><span class=pc8 title="line 717 char 155 count 1">)</span><span class=pc8 title="line 717 char 121 count 1">)</span><span class=pc8 title="line 717 char 93 count 1">)</span><span class=pc8 title="line 717 char 78 count 1"> </span><span class=pc8 title="line 717 char 174 count 1">"\xa;"</span><span class=pc8 title="line 717 char 78 count 1">)</span><span class=pc8 title="line 717 char 50 count 1"> </span><span class=pc8 title="line 717 char 182 count 1">ext-0</span><span class=pc8 title="line 717 char 50 count 1">)</span><span class=pc8 title="line 717 char 37 count 1">)) </span><span class=pc8 title="line 717 char 191 count 1">(let ((act-2 </span><span class=pc8 title="line 717 char 204 count 1">(</span><span class=pc8 title="line 717 char 205 count 1">PreludeC-45IO-prim__putStr</span><span class=pc8 title="line 717 char 204 count 1"> </span><span class=pc8 title="line 717 char 232 count 1">(</span><span class=pc8 title="line 717 char 233 count 1">string-append</span><span class=pc8 title="line 717 char 232 count 1"> </span><span class=pc8 title="line 717 char 247 count 1">(</span><span class=pc8 title="line 717 char 248 count 1">string-append</span><span class=pc8 title="line 717 char 247 count 1"> </span><span class=pc8 title="line 717 char 262 count 1">"multiply 4 5 = "</span><span class=pc8 title="line 717 char 247 count 1"> </span><span class=pc8 title="line 717 char 280 count 1">(</span><span class=pc8 title="line 717 char 281 count 1">PreludeC-45Show-u--show_Show_Int</span><span class=pc8 title="line 717 char 280 count 1"> </span><span class=pc8 title="line 717 char 314 count 1">(</span><span class=pc8 title="line 717 char 315 count 1">Sample-multiply</span><span class=pc8 title="line 717 char 314 count 1"> </span><span class=pc8 title="line 717 char 331 count 1">4</span><span class=pc8 title="line 717 char 314 count 1"> </span><span class=pc8 title="line 717 char 333 count 1">5</span><span class=pc8 title="line 717 char 314 count 1">)</span><span class=pc8 title="line 717 char 280 count 1">)</span><span class=pc8 title="line 717 char 247 count 1">)</span><span class=pc8 title="line 717 char 232 count 1"> </span><span class=pc8 title="line 717 char 338 count 1">"\xa;"</span><span class=pc8 title="line 717 char 232 count 1">)</span><span class=pc8 title="line 717 char 204 count 1"> </span><span class=pc8 title="line 717 char 346 count 1">ext-0</span><span class=pc8 title="line 717 char 204 count 1">)</span><span class=pc8 title="line 717 char 191 count 1">)) </span><span class=pc8 title="line 717 char 355 count 1">(</span><span class=pc8 title="line 717 char 356 count 1">PreludeC-45IO-prim__putStr</span><span class=pc8 title="line 717 char 355 count 1"> </span><span class=pc8 title="line 717 char 383 count 1">(</span><span class=pc8 title="line 717 char 384 count 1">string-append</span><span class=pc8 title="line 717 char 383 count 1"> </span><span class=pc8 title="line 717 char 398 count 1">(</span><span class=pc8 title="line 717 char 399 count 1">string-append</span><span class=pc8 title="line 717 char 398 count 1"> </span><span class=pc8 title="line 717 char 413 count 1">"factorial 5 = "</span><span class=pc8 title="line 717 char 398 count 1"> </span><span class=pc8 title="line 717 char 430 count 1">(</span><span class=pc8 title="line 717 char 431 count 1">PreludeC-45Show-u--show_Show_Int</span><span class=pc8 title="line 717 char 430 count 1"> </span><span class=pc8 title="line 717 char 464 count 1">(</span><span class=pc8 title="line 717 char 465 count 1">Sample-factorial</span><span class=pc8 title="line 717 char 464 count 1"> </span><span class=pc8 title="line 717 char 482 count 1">5</span><span class=pc8 title="line 717 char 464 count 1">)</span><span class=pc8 title="line 717 char 430 count 1">)</span><span class=pc8 title="line 717 char 398 count 1">)</span><span class=pc8 title="line 717 char 383 count 1"> </span><span class=pc8 title="line 717 char 487 count 1">"\xa;"</span><span class=pc8 title="line 717 char 383 count 1">)</span><span class=pc8 title="line 717 char 355 count 1"> </span><span class=pc8 title="line 717 char 495 count 1">ext-0</span><span class=pc8 title="line 717 char 355 count 1">)</span><span class=pc8 title="line 717 char 191 count 1">)</span><span class=pc8 title="line 717 char 37 count 1">)</span><span class=pc8 title="line 717 char 21 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45Types-prim__integerToNat </span><span class=pc8 title="line 718 char 45 count 1">(lambda (arg-0) (let ((sc0 (or (and (&lt;= 0 arg-0) 1) 0))) (cond ((equal? sc0 0) 0)(else arg-0))))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PreludeC-45EqOrd-compareInteger </span><span class=pc8 title="line 719 char 41 count 1">(lambda (ext-0 ext-1) (PreludeC-45EqOrd-u--compare_Ord_Integer ext-0 ext-1))</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PrimIO-unsafeCreateWorld </span><span class=pc8 title="line 720 char 34 count 1">(lambda (arg-1) </span><span class=pc8 title="line 720 char 50 count 1">(</span><span class=pc8 title="line 720 char 51 count 1">arg-1</span><span class=pc8 title="line 720 char 50 count 1"> </span><span class=pc8 title="line 720 char 57 count 1">#f</span><span class=pc8 title="line 720 char 50 count 1">)</span><span class=pc8 title="line 720 char 34 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 16 char 1 count 1">(define PrimIO-unsafePerformIO </span><span class=pc8 title="line 721 char 32 count 1">(lambda (arg-1) </span><span class=pc8 title="line 721 char 48 count 1">(</span><span class=pc8 title="line 721 char 49 count 1">PrimIO-unsafeCreateWorld</span><span class=pc8 title="line 721 char 48 count 1"> </span><span class=pc8 title="line 721 char 74 count 1">(lambda (u--w) </span><span class=pc8 title="line 721 char 89 count 1">(</span><span class=pc8 title="line 721 char 90 count 1">arg-1</span><span class=pc8 title="line 721 char 89 count 1"> </span><span class=pc8 title="line 721 char 96 count 1">u--w</span><span class=pc8 title="line 721 char 89 count 1">)</span><span class=pc8 title="line 721 char 74 count 1">)</span><span class=pc8 title="line 721 char 48 count 1">)</span><span class=pc8 title="line 721 char 32 count 1">)</span><span class=pc8 title="line 16 char 1 count 1">)</span>
<span class=pc8 title="line 722 char 1 count 1">(</span><span class=pc8 title="line 722 char 2 count 1">collect-request-handler</span>
  <span class=pc8 title="line 723 char 3 count 1">(let* ([gc-counter </span><span class=pc8 title="line 723 char 22 count 1">1</span><span class=pc8 title="line 723 char 3 count 1">]</span>
         <span class=pc8 title="line 723 char 3 count 1">[log-radix </span><span class=pc8 title="line 724 char 21 count 1">2</span><span class=pc8 title="line 723 char 3 count 1">]</span>
         <span class=pc8 title="line 723 char 3 count 1">[radix-mask </span><span class=pc8 title="line 725 char 22 count 1">(</span><span class=pc8 title="line 725 char 23 count 1">sub1</span><span class=pc8 title="line 725 char 22 count 1"> </span><span class=pc8 title="line 725 char 28 count 1">(</span><span class=pc8 title="line 725 char 29 count 1">bitwise-arithmetic-shift</span><span class=pc8 title="line 725 char 28 count 1"> </span><span class=pc8 title="line 725 char 54 count 1">1</span><span class=pc8 title="line 725 char 28 count 1"> </span><span class=pc8 title="line 725 char 56 count 1">log-radix</span><span class=pc8 title="line 725 char 28 count 1">)</span><span class=pc8 title="line 725 char 22 count 1">)</span><span class=pc8 title="line 723 char 3 count 1">]</span>
         <span class=pc8 title="line 723 char 3 count 1">[major-gc-factor </span><span class=pc8 title="line 726 char 27 count 1">2</span><span class=pc8 title="line 723 char 3 count 1">]</span>
         <span class=pc8 title="line 723 char 3 count 1">[trigger-major-gc-allocated </span><span class=pc8 title="line 727 char 38 count 1">(</span><span class=pc8 title="line 727 char 39 count 1">*</span><span class=pc8 title="line 727 char 38 count 1"> </span><span class=pc8 title="line 727 char 41 count 1">major-gc-factor</span><span class=pc8 title="line 727 char 38 count 1"> </span><span class=pc8 title="line 727 char 57 count 1">(</span><span class=pc8 title="line 727 char 58 count 1">bytes-allocated</span><span class=pc8 title="line 727 char 57 count 1">)</span><span class=pc8 title="line 727 char 38 count 1">)</span><span class=pc8 title="line 723 char 3 count 1">])</span>
    <span class=pc8 title="line 728 char 5 count 1">(lambda ()</span>
      <span class=pc1 title="line 729 char 7 count 0">(cond</span>
        <span class=pc1 title="line 729 char 7 count 0">[</span><span class=pc1 title="line 730 char 10 count 0">(</span><span class=pc1 title="line 730 char 11 count 0">&gt;=</span><span class=pc1 title="line 730 char 10 count 0"> </span><span class=pc1 title="line 730 char 14 count 0">(</span><span class=pc1 title="line 730 char 15 count 0">bytes-allocated</span><span class=pc1 title="line 730 char 14 count 0">)</span><span class=pc1 title="line 730 char 10 count 0"> </span><span class=pc1 title="line 730 char 32 count 0">trigger-major-gc-allocated</span><span class=pc1 title="line 730 char 10 count 0">)</span>
         <span class=pc1 title="line 729 char 7 count 0">;; Force a major collection if memory use has doubled</span>
         <span class=pc1 title="line 732 char 10 count 0">(</span><span class=pc1 title="line 732 char 11 count 0">collect</span><span class=pc1 title="line 732 char 10 count 0"> </span><span class=pc1 title="line 732 char 19 count 0">(</span><span class=pc1 title="line 732 char 20 count 0">collect-maximum-generation</span><span class=pc1 title="line 732 char 19 count 0">)</span><span class=pc1 title="line 732 char 10 count 0">)</span>
         <span class=pc1 title="line 733 char 10 count 0">(</span><span class=pc1 title="line 733 char 11 count 0">blodwen-run-finalisers</span><span class=pc1 title="line 733 char 10 count 0">)</span>
         <span class=pc1 title="line 734 char 10 count 0">(set! trigger-major-gc-allocated </span><span class=pc1 title="line 734 char 43 count 0">(</span><span class=pc1 title="line 734 char 44 count 0">*</span><span class=pc1 title="line 734 char 43 count 0"> </span><span class=pc1 title="line 734 char 46 count 0">major-gc-factor</span><span class=pc1 title="line 734 char 43 count 0"> </span><span class=pc1 title="line 734 char 62 count 0">(</span><span class=pc1 title="line 734 char 63 count 0">bytes-allocated</span><span class=pc1 title="line 734 char 62 count 0">)</span><span class=pc1 title="line 734 char 43 count 0">)</span><span class=pc1 title="line 734 char 10 count 0">)</span><span class=pc1 title="line 729 char 7 count 0">]</span>
        <span class=pc1 title="line 729 char 7 count 0">[else</span>
         <span class=pc1 title="line 729 char 7 count 0">;; Imitate the built-in rule, but without ever going to a major collection</span>
         <span class=pc1 title="line 737 char 10 count 0">(let ([this-counter </span><span class=pc1 title="line 737 char 30 count 0">gc-counter</span><span class=pc1 title="line 737 char 10 count 0">])</span>
           <span class=pc1 title="line 738 char 12 count 0">(if </span><span class=pc1 title="line 738 char 16 count 0">(</span><span class=pc1 title="line 738 char 17 count 0">&gt;</span><span class=pc1 title="line 738 char 16 count 0"> </span><span class=pc1 title="line 738 char 19 count 0">(</span><span class=pc1 title="line 738 char 20 count 0">add1</span><span class=pc1 title="line 738 char 19 count 0"> </span><span class=pc1 title="line 738 char 25 count 0">this-counter</span><span class=pc1 title="line 738 char 19 count 0">)</span>
                  <span class=pc1 title="line 739 char 19 count 0">(</span><span class=pc1 title="line 739 char 20 count 0">bitwise-arithmetic-shift-left</span><span class=pc1 title="line 739 char 19 count 0"> </span><span class=pc1 title="line 739 char 50 count 0">1</span><span class=pc1 title="line 739 char 19 count 0"> </span><span class=pc1 title="line 739 char 52 count 0">(</span><span class=pc1 title="line 739 char 53 count 0">*</span><span class=pc1 title="line 739 char 52 count 0"> </span><span class=pc1 title="line 739 char 55 count 0">log-radix</span><span class=pc1 title="line 739 char 52 count 0"> </span><span class=pc1 title="line 739 char 65 count 0">(</span><span class=pc1 title="line 739 char 66 count 0">sub1</span><span class=pc1 title="line 739 char 65 count 0"> </span><span class=pc1 title="line 739 char 71 count 0">(</span><span class=pc1 title="line 739 char 72 count 0">collect-maximum-generation</span><span class=pc1 title="line 739 char 71 count 0">)</span><span class=pc1 title="line 739 char 65 count 0">)</span><span class=pc1 title="line 739 char 52 count 0">)</span><span class=pc1 title="line 739 char 19 count 0">)</span><span class=pc1 title="line 738 char 16 count 0">)</span>
               <span class=pc1 title="line 740 char 16 count 0">(set! gc-counter </span><span class=pc1 title="line 740 char 33 count 0">1</span><span class=pc1 title="line 740 char 16 count 0">)</span>
               <span class=pc1 title="line 741 char 16 count 0">(set! gc-counter </span><span class=pc1 title="line 741 char 33 count 0">(</span><span class=pc1 title="line 741 char 34 count 0">add1</span><span class=pc1 title="line 741 char 33 count 0"> </span><span class=pc1 title="line 741 char 39 count 0">this-counter</span><span class=pc1 title="line 741 char 33 count 0">)</span><span class=pc1 title="line 741 char 16 count 0">)</span><span class=pc1 title="line 738 char 12 count 0">)</span>
           <span class=pc1 title="line 742 char 12 count 0">(</span><span class=pc1 title="line 742 char 13 count 0">collect</span>
            <span class=pc1 title="line 742 char 12 count 0">;; Find the minor generation implied by the counter</span>
            <span class=pc1 title="line 744 char 13 count 0">(let loop ([c </span><span class=pc1 title="line 744 char 27 count 0">this-counter</span><span class=pc1 title="line 744 char 13 count 0">] [gen </span><span class=pc1 title="line 744 char 46 count 0">0</span><span class=pc1 title="line 744 char 13 count 0">])</span>
              <span class=pc1 title="line 745 char 15 count 0">(cond</span>
                <span class=pc1 title="line 745 char 15 count 0">[</span><span class=pc1 title="line 746 char 18 count 0">(</span><span class=pc1 title="line 746 char 19 count 0">zero?</span><span class=pc1 title="line 746 char 18 count 0"> </span><span class=pc1 title="line 746 char 25 count 0">(</span><span class=pc1 title="line 746 char 26 count 0">bitwise-and</span><span class=pc1 title="line 746 char 25 count 0"> </span><span class=pc1 title="line 746 char 38 count 0">c</span><span class=pc1 title="line 746 char 25 count 0"> </span><span class=pc1 title="line 746 char 40 count 0">radix-mask</span><span class=pc1 title="line 746 char 25 count 0">)</span><span class=pc1 title="line 746 char 18 count 0">)</span>
                 <span class=pc1 title="line 747 char 18 count 0">(</span><span class=pc1 title="line 747 char 19 count 0">loop</span><span class=pc1 title="line 747 char 18 count 0"> </span><span class=pc1 title="line 747 char 24 count 0">(</span><span class=pc1 title="line 747 char 25 count 0">bitwise-arithmetic-shift-right</span><span class=pc1 title="line 747 char 24 count 0"> </span><span class=pc1 title="line 747 char 56 count 0">c</span><span class=pc1 title="line 747 char 24 count 0"> </span><span class=pc1 title="line 747 char 58 count 0">log-radix</span><span class=pc1 title="line 747 char 24 count 0">)</span>
                       <span class=pc1 title="line 748 char 24 count 0">(</span><span class=pc1 title="line 748 char 25 count 0">add1</span><span class=pc1 title="line 748 char 24 count 0"> </span><span class=pc1 title="line 748 char 30 count 0">gen</span><span class=pc1 title="line 748 char 24 count 0">)</span><span class=pc1 title="line 747 char 18 count 0">)</span><span class=pc1 title="line 745 char 15 count 0">]</span>
                <span class=pc1 title="line 745 char 15 count 0">[else</span>
                 <span class=pc1 title="line 750 char 18 count 0">gen</span><span class=pc1 title="line 745 char 15 count 0">])</span><span class=pc1 title="line 744 char 13 count 0">)</span><span class=pc1 title="line 742 char 12 count 0">)</span><span class=pc1 title="line 737 char 10 count 0">)</span><span class=pc1 title="line 729 char 7 count 0">])</span><span class=pc8 title="line 728 char 5 count 1">)</span><span class=pc8 title="line 723 char 3 count 1">)</span><span class=pc8 title="line 722 char 1 count 1">)</span>
<span class=pc8 title="line 751 char 1 count 1">(</span><span class=pc8 title="line 751 char 2 count 1">PrimIO-unsafePerformIO</span><span class=pc8 title="line 751 char 1 count 1"> </span><span class=pc8 title="line 751 char 25 count 1">(lambda (eta-0) </span><span class=pc8 title="line 751 char 41 count 1">(</span><span class=pc8 title="line 751 char 42 count 1">Sample-main</span><span class=pc8 title="line 751 char 41 count 1"> </span><span class=pc8 title="line 751 char 54 count 1">eta-0</span><span class=pc8 title="line 751 char 41 count 1">)</span><span class=pc8 title="line 751 char 25 count 1">)</span><span class=pc8 title="line 751 char 1 count 1">)</span>
  <span class=pc8 title="line 752 char 3 count 1">(</span><span class=pc8 title="line 752 char 4 count 1">collect-request-handler</span><span class=pc8 title="line 752 char 3 count 1"> </span><span class=pc8 title="line 752 char 28 count 1">(lambda () </span><span class=pc8 title="line 752 char 39 count 1">(</span><span class=pc8 title="line 752 char 40 count 1">collect</span><span class=pc8 title="line 752 char 39 count 1"> </span><span class=pc8 title="line 752 char 48 count 1">(</span><span class=pc8 title="line 752 char 49 count 1">collect-maximum-generation</span><span class=pc8 title="line 752 char 48 count 1">)</span><span class=pc8 title="line 752 char 39 count 1">)</span><span class=pc8 title="line 752 char 28 count 1"> </span><span class=pc8 title="line 752 char 78 count 1">(</span><span class=pc8 title="line 752 char 79 count 1">blodwen-run-finalisers</span><span class=pc8 title="line 752 char 78 count 1">)</span><span class=pc8 title="line 752 char 28 count 1">)</span><span class=pc8 title="line 752 char 3 count 1">)</span>
  <span class=pc8 title="line 753 char 3 count 1">(</span><span class=pc8 title="line 753 char 4 count 1">collect-rendezvous</span><span class=pc8 title="line 753 char 3 count 1">)</span>
  <span class=pc8 title="line 754 char 3 count 1">(</span><span class=pc8 title="line 754 char 4 count 1">profile-dump-html</span><span class=pc8 title="line 754 char 3 count 1">)</span>
  <span class=pc8 title="line 16 char 1 count 1">)</span></pre></td></tr></table>
</body>
</html>